""" elsa.py - Synthetic Cirq implementation.
=== Reference ===
Part of the SQUARE benchmark set: https://arxiv.org/abs/2004.08539
"""
# Cirq file synthesized by rand_bench_cirq.py
# qubits: 128 ancilla: 8 gates: 256 levels: 2 degrees: 3
import random
import cirq
from cirq.ops import raw_types
# Call list: 1;2,3,4;5,6
# Function 6 with degree 0
# nq: 83, na: 2, ng: 209
class Func6(cirq.Gate):
	def __init__(self, num_qubits, is_inverse=False):
		self._num_qubits = num_qubits
		self.is_inverse = is_inverse
	def num_qubits(self):
		return self._num_qubits
	def __pow__(self, power):
		if power == -1:
			return Func6(self._num_qubits, is_inverse=True)
		else:
			return NotImplemented
	def _decompose_(self, qubits):
		anc = qubits[83:] # ancilla
		res = [qubits[9], qubits[38], qubits[74], qubits[22], qubits[52], qubits[64], qubits[80], qubits[21], qubits[28], qubits[67], qubits[60], qubits[14], qubits[76], qubits[17], qubits[36], qubits[10], qubits[34], qubits[41], qubits[75], qubits[19], qubits[69], qubits[20], qubits[40], qubits[53], qubits[63], qubits[18], qubits[2], qubits[54], qubits[55], qubits[26], qubits[58], qubits[30], qubits[6], qubits[5], qubits[24], qubits[48], qubits[79], qubits[77], qubits[23]]
		# Leaf function
		if not self.is_inverse: 
			# Compute 
			yield cirq.TOFFOLI( qubits[65], qubits[22], qubits[25] )
			yield cirq.CNOT( qubits[37], qubits[6] )
			yield cirq.TOFFOLI( anc[1], qubits[28], qubits[40] )
			yield cirq.TOFFOLI( qubits[2], qubits[50], qubits[35] )
			yield cirq.CNOT( qubits[60], qubits[38] )
			yield cirq.CNOT( qubits[82], qubits[24] )
			yield cirq.CNOT( qubits[37], qubits[66] )
			yield cirq.TOFFOLI( qubits[39], qubits[25], qubits[36] )
			yield cirq.CNOT( qubits[44], qubits[78] )
			yield cirq.CNOT( qubits[22], qubits[44] )
			yield cirq.TOFFOLI( qubits[52], qubits[56], qubits[62] )
			yield cirq.CNOT( qubits[66], qubits[79] )
			yield cirq.TOFFOLI( qubits[47], qubits[5], qubits[38] )
			yield cirq.TOFFOLI( qubits[61], qubits[72], anc[0] )
			yield cirq.CNOT( qubits[58], qubits[7] )
			yield cirq.CNOT( qubits[12], qubits[77] )
			yield cirq.TOFFOLI( qubits[65], qubits[0], qubits[13] )
			yield cirq.CNOT( qubits[28], qubits[55] )
			yield cirq.TOFFOLI( qubits[23], qubits[25], qubits[33] )
			yield cirq.CNOT( qubits[79], qubits[73] )
			yield cirq.TOFFOLI( qubits[79], qubits[50], qubits[45] )
			yield cirq.CNOT( qubits[68], qubits[22] )
			yield cirq.TOFFOLI( qubits[70], qubits[17], anc[0] )
			yield cirq.CNOT( qubits[10], qubits[66] )
			yield cirq.TOFFOLI( qubits[4], qubits[8], qubits[9] )
			yield cirq.TOFFOLI( qubits[56], qubits[57], qubits[37] )
			yield cirq.CNOT( qubits[31], qubits[61] )
			yield cirq.CNOT( qubits[46], qubits[17] )
			yield cirq.TOFFOLI( qubits[40], qubits[29], qubits[32] )
			yield cirq.CNOT( qubits[0], qubits[41] )
			yield cirq.TOFFOLI( qubits[22], qubits[82], qubits[20] )
			yield cirq.TOFFOLI( anc[1], qubits[62], qubits[77] )
			yield cirq.CNOT( qubits[16], qubits[49] )
			yield cirq.CNOT( qubits[53], qubits[51] )
			yield cirq.CNOT( qubits[45], qubits[23] )
			yield cirq.CNOT( qubits[14], qubits[31] )
			yield cirq.CNOT( qubits[8], qubits[32] )
			yield cirq.TOFFOLI( qubits[28], qubits[14], anc[1] )
			yield cirq.TOFFOLI( qubits[73], qubits[35], qubits[33] )
			yield cirq.CNOT( qubits[63], qubits[7] )
			yield cirq.CNOT( qubits[8], qubits[57] )
			yield cirq.TOFFOLI( qubits[81], qubits[46], qubits[28] )
			yield cirq.TOFFOLI( qubits[13], qubits[47], qubits[40] )
			yield cirq.TOFFOLI( qubits[6], qubits[54], qubits[11] )
			yield cirq.TOFFOLI( qubits[45], qubits[35], qubits[39] )
			yield cirq.CNOT( qubits[77], qubits[20] )
			yield cirq.CNOT( qubits[10], qubits[58] )
			yield cirq.CNOT( qubits[25], qubits[49] )
			yield cirq.CNOT( qubits[72], qubits[71] )
			yield cirq.TOFFOLI( qubits[23], qubits[37], qubits[30] )
			yield cirq.CNOT( qubits[14], qubits[17] )
			yield cirq.CNOT( qubits[20], qubits[42] )
			yield cirq.TOFFOLI( qubits[82], qubits[54], qubits[63] )
			yield cirq.TOFFOLI( qubits[18], qubits[7], qubits[26] )
			yield cirq.TOFFOLI( qubits[63], qubits[12], qubits[59] )
			yield cirq.CNOT( qubits[66], qubits[10] )
			yield cirq.TOFFOLI( qubits[25], qubits[45], qubits[39] )
			yield cirq.TOFFOLI( qubits[45], qubits[20], qubits[32] )
			yield cirq.TOFFOLI( qubits[60], qubits[70], qubits[67] )
			yield cirq.CNOT( qubits[8], qubits[38] )
			yield cirq.TOFFOLI( qubits[23], qubits[73], qubits[62] )
			yield cirq.TOFFOLI( qubits[13], qubits[11], qubits[32] )
			yield cirq.CNOT( qubits[65], qubits[70] )
			yield cirq.TOFFOLI( qubits[66], qubits[70], qubits[51] )
			yield cirq.CNOT( anc[0], qubits[51] )
			yield cirq.TOFFOLI( qubits[21], qubits[65], qubits[58] )
			yield cirq.CNOT( qubits[61], qubits[44] )
			yield cirq.CNOT( qubits[49], qubits[37] )
			yield cirq.TOFFOLI( qubits[50], qubits[69], qubits[52] )
			yield cirq.TOFFOLI( qubits[65], qubits[77], qubits[76] )
			yield cirq.CNOT( qubits[31], qubits[26] )
			yield cirq.TOFFOLI( qubits[2], qubits[60], qubits[76] )
			yield cirq.TOFFOLI( qubits[6], qubits[16], qubits[43] )
			yield cirq.CNOT( qubits[53], qubits[74] )
			yield cirq.TOFFOLI( qubits[65], qubits[43], qubits[18] )
			yield cirq.CNOT( qubits[78], qubits[68] )
			yield cirq.TOFFOLI( qubits[12], qubits[75], qubits[82] )
			yield cirq.TOFFOLI( qubits[53], qubits[47], qubits[63] )
			yield cirq.TOFFOLI( qubits[42], qubits[56], qubits[75] )
			yield cirq.TOFFOLI( qubits[60], qubits[40], qubits[7] )
			yield cirq.TOFFOLI( qubits[31], qubits[2], anc[1] )
			yield cirq.CNOT( qubits[48], qubits[75] )
			yield cirq.TOFFOLI( qubits[36], qubits[29], qubits[75] )
			yield cirq.CNOT( qubits[32], qubits[56] )
			yield cirq.CNOT( qubits[64], qubits[66] )
			yield cirq.CNOT( qubits[13], qubits[37] )
			yield cirq.TOFFOLI( qubits[6], qubits[33], qubits[64] )
			yield cirq.TOFFOLI( qubits[23], anc[0], qubits[73] )
			yield cirq.TOFFOLI( qubits[65], qubits[60], qubits[3] )
			yield cirq.TOFFOLI( qubits[64], anc[0], qubits[38] )
			yield cirq.CNOT( anc[0], qubits[79] )
			yield cirq.TOFFOLI( qubits[61], qubits[46], qubits[55] )
			yield cirq.CNOT( qubits[29], qubits[63] )
			yield cirq.CNOT( qubits[15], qubits[58] )
			yield cirq.TOFFOLI( qubits[2], qubits[31], qubits[30] )
			yield cirq.TOFFOLI( qubits[60], qubits[3], qubits[32] )
			yield cirq.CNOT( qubits[63], qubits[29] )
			yield cirq.CNOT( qubits[16], qubits[48] )
			yield cirq.TOFFOLI( qubits[4], qubits[11], qubits[56] )
			yield cirq.CNOT( qubits[60], qubits[56] )
			yield cirq.TOFFOLI( qubits[8], qubits[29], qubits[26] )
			yield cirq.TOFFOLI( qubits[4], qubits[75], qubits[78] )
			yield cirq.TOFFOLI( qubits[56], qubits[63], qubits[28] )
			yield cirq.TOFFOLI( qubits[21], qubits[51], qubits[22] )
			yield cirq.TOFFOLI( qubits[39], qubits[71], qubits[22] )
			yield cirq.CNOT( qubits[13], qubits[58] )
			yield cirq.TOFFOLI( qubits[7], qubits[28], qubits[16] )
			yield cirq.CNOT( qubits[76], qubits[13] )
			yield cirq.TOFFOLI( qubits[55], qubits[31], qubits[33] )
			yield cirq.TOFFOLI( qubits[68], qubits[79], qubits[16] )
			yield cirq.CNOT( qubits[63], qubits[17] )
			yield cirq.TOFFOLI( qubits[9], qubits[76], qubits[29] )
			yield cirq.TOFFOLI( qubits[36], qubits[64], qubits[27] )
			yield cirq.TOFFOLI( qubits[65], qubits[1], qubits[8] )
			yield cirq.TOFFOLI( qubits[63], qubits[18], qubits[71] )
			yield cirq.CNOT( qubits[68], anc[1] )
			yield cirq.CNOT( qubits[10], qubits[44] )
			yield cirq.CNOT( qubits[22], qubits[77] )
			yield cirq.CNOT( qubits[28], qubits[66] )
			yield cirq.TOFFOLI( qubits[16], qubits[64], qubits[81] )
			yield cirq.TOFFOLI( qubits[44], qubits[71], qubits[66] )
			yield cirq.CNOT( qubits[61], qubits[1] )
			yield cirq.CNOT( qubits[23], qubits[37] )
			yield cirq.CNOT( qubits[43], qubits[54] )
			yield cirq.CNOT( qubits[63], qubits[46] )
			yield cirq.TOFFOLI( anc[1], qubits[36], qubits[75] )
			yield cirq.CNOT( qubits[9], qubits[26] )
			yield cirq.CNOT( qubits[14], qubits[48] )
			yield cirq.CNOT( qubits[7], qubits[3] )
			yield cirq.TOFFOLI( qubits[78], qubits[10], qubits[34] )
			yield cirq.CNOT( qubits[60], qubits[12] )
			yield cirq.CNOT( anc[0], qubits[9] )
			yield cirq.CNOT( qubits[53], qubits[73] )
			yield cirq.TOFFOLI( qubits[14], qubits[61], qubits[39] )
			yield cirq.TOFFOLI( qubits[66], qubits[51], qubits[12] )
			yield cirq.CNOT( qubits[16], qubits[55] )
			yield cirq.CNOT( qubits[25], qubits[61] )
			yield cirq.CNOT( qubits[39], qubits[56] )
			yield cirq.TOFFOLI( anc[1], qubits[0], qubits[1] )
			yield cirq.CNOT( qubits[71], anc[0] )
			yield cirq.CNOT( qubits[76], qubits[0] )
			yield cirq.CNOT( qubits[44], qubits[48] )
			yield cirq.TOFFOLI( qubits[50], qubits[78], qubits[31] )
			yield cirq.TOFFOLI( qubits[7], qubits[15], qubits[61] )
			yield cirq.TOFFOLI( qubits[55], qubits[65], qubits[29] )
			yield cirq.TOFFOLI( qubits[19], qubits[10], qubits[28] )
			yield cirq.CNOT( qubits[57], qubits[37] )
			yield cirq.CNOT( qubits[53], qubits[39] )
			yield cirq.CNOT( qubits[63], qubits[71] )
			yield cirq.TOFFOLI( qubits[25], qubits[38], qubits[61] )
			yield cirq.TOFFOLI( qubits[77], qubits[48], qubits[33] )
			yield cirq.CNOT( qubits[14], anc[0] )
			yield cirq.TOFFOLI( qubits[21], qubits[53], qubits[70] )
			yield cirq.TOFFOLI( qubits[68], qubits[28], qubits[36] )
			yield cirq.TOFFOLI( qubits[51], qubits[45], qubits[81] )
			yield cirq.CNOT( qubits[13], qubits[52] )
			yield cirq.CNOT( qubits[60], qubits[37] )
			yield cirq.TOFFOLI( qubits[27], qubits[80], qubits[47] )
			yield cirq.TOFFOLI( qubits[25], qubits[34], qubits[32] )
			yield cirq.TOFFOLI( qubits[8], qubits[5], qubits[66] )
			yield cirq.TOFFOLI( qubits[16], qubits[76], qubits[19] )
			yield cirq.TOFFOLI( qubits[57], qubits[68], qubits[23] )
			yield cirq.TOFFOLI( qubits[3], qubits[16], qubits[20] )
			yield cirq.CNOT( qubits[35], qubits[63] )
			yield cirq.TOFFOLI( qubits[80], qubits[74], qubits[2] )
			yield cirq.CNOT( qubits[17], qubits[76] )
			yield cirq.CNOT( qubits[72], qubits[7] )
			yield cirq.CNOT( qubits[20], qubits[46] )
			yield cirq.CNOT( qubits[0], qubits[31] )
			yield cirq.TOFFOLI( qubits[3], qubits[34], qubits[61] )
			yield cirq.CNOT( qubits[34], qubits[3] )
			yield cirq.CNOT( qubits[28], qubits[38] )
			yield cirq.TOFFOLI( qubits[46], qubits[9], anc[1] )
			yield cirq.TOFFOLI( qubits[35], anc[0], qubits[9] )
			yield cirq.CNOT( qubits[14], qubits[68] )
			yield cirq.TOFFOLI( qubits[14], qubits[47], qubits[10] )
			yield cirq.TOFFOLI( qubits[19], qubits[73], qubits[43] )
			yield cirq.CNOT( qubits[57], qubits[13] )
			yield cirq.CNOT( qubits[33], qubits[9] )
			yield cirq.CNOT( qubits[79], qubits[63] )
			yield cirq.TOFFOLI( qubits[20], qubits[35], qubits[43] )
			yield cirq.CNOT( qubits[26], qubits[78] )
			yield cirq.TOFFOLI( qubits[74], qubits[47], qubits[37] )
			yield cirq.CNOT( qubits[70], qubits[29] )
			yield cirq.TOFFOLI( qubits[42], anc[1], qubits[53] )
			yield cirq.TOFFOLI( qubits[39], qubits[64], qubits[13] )
			yield cirq.CNOT( qubits[56], qubits[15] )
			yield cirq.CNOT( qubits[77], qubits[11] )
			yield cirq.CNOT( qubits[72], qubits[6] )
			yield cirq.TOFFOLI( qubits[74], anc[0], qubits[31] )
			yield cirq.TOFFOLI( qubits[68], qubits[51], qubits[10] )
			yield cirq.CNOT( qubits[71], qubits[12] )
			yield cirq.CNOT( qubits[10], qubits[60] )
			yield cirq.CNOT( qubits[71], anc[0] )
			yield cirq.TOFFOLI( qubits[28], qubits[65], qubits[31] )
			yield cirq.CNOT( qubits[24], qubits[60] )
			yield cirq.CNOT( qubits[50], qubits[10] )
			yield cirq.CNOT( qubits[14], qubits[20] )
			yield cirq.TOFFOLI( qubits[5], qubits[64], qubits[25] )
			yield cirq.CNOT( qubits[22], qubits[65] )
			yield cirq.TOFFOLI( qubits[35], qubits[67], qubits[19] )
			yield cirq.CNOT( qubits[5], qubits[46] )
			yield cirq.TOFFOLI( qubits[66], qubits[56], qubits[39] )
			yield cirq.TOFFOLI( qubits[65], qubits[18], qubits[70] )
			yield cirq.TOFFOLI( qubits[9], qubits[8], qubits[61] )
			yield cirq.TOFFOLI( qubits[18], qubits[36], qubits[14] )
			yield cirq.CNOT( qubits[59], qubits[31] )
			yield cirq.TOFFOLI( qubits[22], qubits[80], qubits[7] )
			yield cirq.TOFFOLI( qubits[78], qubits[68], qubits[19] )
			# Store 
			# Note: this version does not store results.
		else: 
			# Uncompute 
			yield cirq.TOFFOLI( qubits[78], qubits[68], qubits[19] )
			yield cirq.TOFFOLI( qubits[22], qubits[80], qubits[7] )
			yield cirq.CNOT( qubits[59], qubits[31] )
			yield cirq.TOFFOLI( qubits[18], qubits[36], qubits[14] )
			yield cirq.TOFFOLI( qubits[9], qubits[8], qubits[61] )
			yield cirq.TOFFOLI( qubits[65], qubits[18], qubits[70] )
			yield cirq.TOFFOLI( qubits[66], qubits[56], qubits[39] )
			yield cirq.CNOT( qubits[5], qubits[46] )
			yield cirq.TOFFOLI( qubits[35], qubits[67], qubits[19] )
			yield cirq.CNOT( qubits[22], qubits[65] )
			yield cirq.TOFFOLI( qubits[5], qubits[64], qubits[25] )
			yield cirq.CNOT( qubits[14], qubits[20] )
			yield cirq.CNOT( qubits[50], qubits[10] )
			yield cirq.CNOT( qubits[24], qubits[60] )
			yield cirq.TOFFOLI( qubits[28], qubits[65], qubits[31] )
			yield cirq.CNOT( qubits[71], anc[0] )
			yield cirq.CNOT( qubits[10], qubits[60] )
			yield cirq.CNOT( qubits[71], qubits[12] )
			yield cirq.TOFFOLI( qubits[68], qubits[51], qubits[10] )
			yield cirq.TOFFOLI( qubits[74], anc[0], qubits[31] )
			yield cirq.CNOT( qubits[72], qubits[6] )
			yield cirq.CNOT( qubits[77], qubits[11] )
			yield cirq.CNOT( qubits[56], qubits[15] )
			yield cirq.TOFFOLI( qubits[39], qubits[64], qubits[13] )
			yield cirq.TOFFOLI( qubits[42], anc[1], qubits[53] )
			yield cirq.CNOT( qubits[70], qubits[29] )
			yield cirq.TOFFOLI( qubits[74], qubits[47], qubits[37] )
			yield cirq.CNOT( qubits[26], qubits[78] )
			yield cirq.TOFFOLI( qubits[20], qubits[35], qubits[43] )
			yield cirq.CNOT( qubits[79], qubits[63] )
			yield cirq.CNOT( qubits[33], qubits[9] )
			yield cirq.CNOT( qubits[57], qubits[13] )
			yield cirq.TOFFOLI( qubits[19], qubits[73], qubits[43] )
			yield cirq.TOFFOLI( qubits[14], qubits[47], qubits[10] )
			yield cirq.CNOT( qubits[14], qubits[68] )
			yield cirq.TOFFOLI( qubits[35], anc[0], qubits[9] )
			yield cirq.TOFFOLI( qubits[46], qubits[9], anc[1] )
			yield cirq.CNOT( qubits[28], qubits[38] )
			yield cirq.CNOT( qubits[34], qubits[3] )
			yield cirq.TOFFOLI( qubits[3], qubits[34], qubits[61] )
			yield cirq.CNOT( qubits[0], qubits[31] )
			yield cirq.CNOT( qubits[20], qubits[46] )
			yield cirq.CNOT( qubits[72], qubits[7] )
			yield cirq.CNOT( qubits[17], qubits[76] )
			yield cirq.TOFFOLI( qubits[80], qubits[74], qubits[2] )
			yield cirq.CNOT( qubits[35], qubits[63] )
			yield cirq.TOFFOLI( qubits[3], qubits[16], qubits[20] )
			yield cirq.TOFFOLI( qubits[57], qubits[68], qubits[23] )
			yield cirq.TOFFOLI( qubits[16], qubits[76], qubits[19] )
			yield cirq.TOFFOLI( qubits[8], qubits[5], qubits[66] )
			yield cirq.TOFFOLI( qubits[25], qubits[34], qubits[32] )
			yield cirq.TOFFOLI( qubits[27], qubits[80], qubits[47] )
			yield cirq.CNOT( qubits[60], qubits[37] )
			yield cirq.CNOT( qubits[13], qubits[52] )
			yield cirq.TOFFOLI( qubits[51], qubits[45], qubits[81] )
			yield cirq.TOFFOLI( qubits[68], qubits[28], qubits[36] )
			yield cirq.TOFFOLI( qubits[21], qubits[53], qubits[70] )
			yield cirq.CNOT( qubits[14], anc[0] )
			yield cirq.TOFFOLI( qubits[77], qubits[48], qubits[33] )
			yield cirq.TOFFOLI( qubits[25], qubits[38], qubits[61] )
			yield cirq.CNOT( qubits[63], qubits[71] )
			yield cirq.CNOT( qubits[53], qubits[39] )
			yield cirq.CNOT( qubits[57], qubits[37] )
			yield cirq.TOFFOLI( qubits[19], qubits[10], qubits[28] )
			yield cirq.TOFFOLI( qubits[55], qubits[65], qubits[29] )
			yield cirq.TOFFOLI( qubits[7], qubits[15], qubits[61] )
			yield cirq.TOFFOLI( qubits[50], qubits[78], qubits[31] )
			yield cirq.CNOT( qubits[44], qubits[48] )
			yield cirq.CNOT( qubits[76], qubits[0] )
			yield cirq.CNOT( qubits[71], anc[0] )
			yield cirq.TOFFOLI( anc[1], qubits[0], qubits[1] )
			yield cirq.CNOT( qubits[39], qubits[56] )
			yield cirq.CNOT( qubits[25], qubits[61] )
			yield cirq.CNOT( qubits[16], qubits[55] )
			yield cirq.TOFFOLI( qubits[66], qubits[51], qubits[12] )
			yield cirq.TOFFOLI( qubits[14], qubits[61], qubits[39] )
			yield cirq.CNOT( qubits[53], qubits[73] )
			yield cirq.CNOT( anc[0], qubits[9] )
			yield cirq.CNOT( qubits[60], qubits[12] )
			yield cirq.TOFFOLI( qubits[78], qubits[10], qubits[34] )
			yield cirq.CNOT( qubits[7], qubits[3] )
			yield cirq.CNOT( qubits[14], qubits[48] )
			yield cirq.CNOT( qubits[9], qubits[26] )
			yield cirq.TOFFOLI( anc[1], qubits[36], qubits[75] )
			yield cirq.CNOT( qubits[63], qubits[46] )
			yield cirq.CNOT( qubits[43], qubits[54] )
			yield cirq.CNOT( qubits[23], qubits[37] )
			yield cirq.CNOT( qubits[61], qubits[1] )
			yield cirq.TOFFOLI( qubits[44], qubits[71], qubits[66] )
			yield cirq.TOFFOLI( qubits[16], qubits[64], qubits[81] )
			yield cirq.CNOT( qubits[28], qubits[66] )
			yield cirq.CNOT( qubits[22], qubits[77] )
			yield cirq.CNOT( qubits[10], qubits[44] )
			yield cirq.CNOT( qubits[68], anc[1] )
			yield cirq.TOFFOLI( qubits[63], qubits[18], qubits[71] )
			yield cirq.TOFFOLI( qubits[65], qubits[1], qubits[8] )
			yield cirq.TOFFOLI( qubits[36], qubits[64], qubits[27] )
			yield cirq.TOFFOLI( qubits[9], qubits[76], qubits[29] )
			yield cirq.CNOT( qubits[63], qubits[17] )
			yield cirq.TOFFOLI( qubits[68], qubits[79], qubits[16] )
			yield cirq.TOFFOLI( qubits[55], qubits[31], qubits[33] )
			yield cirq.CNOT( qubits[76], qubits[13] )
			yield cirq.TOFFOLI( qubits[7], qubits[28], qubits[16] )
			yield cirq.CNOT( qubits[13], qubits[58] )
			yield cirq.TOFFOLI( qubits[39], qubits[71], qubits[22] )
			yield cirq.TOFFOLI( qubits[21], qubits[51], qubits[22] )
			yield cirq.TOFFOLI( qubits[56], qubits[63], qubits[28] )
			yield cirq.TOFFOLI( qubits[4], qubits[75], qubits[78] )
			yield cirq.TOFFOLI( qubits[8], qubits[29], qubits[26] )
			yield cirq.CNOT( qubits[60], qubits[56] )
			yield cirq.TOFFOLI( qubits[4], qubits[11], qubits[56] )
			yield cirq.CNOT( qubits[16], qubits[48] )
			yield cirq.CNOT( qubits[63], qubits[29] )
			yield cirq.TOFFOLI( qubits[60], qubits[3], qubits[32] )
			yield cirq.TOFFOLI( qubits[2], qubits[31], qubits[30] )
			yield cirq.CNOT( qubits[15], qubits[58] )
			yield cirq.CNOT( qubits[29], qubits[63] )
			yield cirq.TOFFOLI( qubits[61], qubits[46], qubits[55] )
			yield cirq.CNOT( anc[0], qubits[79] )
			yield cirq.TOFFOLI( qubits[64], anc[0], qubits[38] )
			yield cirq.TOFFOLI( qubits[65], qubits[60], qubits[3] )
			yield cirq.TOFFOLI( qubits[23], anc[0], qubits[73] )
			yield cirq.TOFFOLI( qubits[6], qubits[33], qubits[64] )
			yield cirq.CNOT( qubits[13], qubits[37] )
			yield cirq.CNOT( qubits[64], qubits[66] )
			yield cirq.CNOT( qubits[32], qubits[56] )
			yield cirq.TOFFOLI( qubits[36], qubits[29], qubits[75] )
			yield cirq.CNOT( qubits[48], qubits[75] )
			yield cirq.TOFFOLI( qubits[31], qubits[2], anc[1] )
			yield cirq.TOFFOLI( qubits[60], qubits[40], qubits[7] )
			yield cirq.TOFFOLI( qubits[42], qubits[56], qubits[75] )
			yield cirq.TOFFOLI( qubits[53], qubits[47], qubits[63] )
			yield cirq.TOFFOLI( qubits[12], qubits[75], qubits[82] )
			yield cirq.CNOT( qubits[78], qubits[68] )
			yield cirq.TOFFOLI( qubits[65], qubits[43], qubits[18] )
			yield cirq.CNOT( qubits[53], qubits[74] )
			yield cirq.TOFFOLI( qubits[6], qubits[16], qubits[43] )
			yield cirq.TOFFOLI( qubits[2], qubits[60], qubits[76] )
			yield cirq.CNOT( qubits[31], qubits[26] )
			yield cirq.TOFFOLI( qubits[65], qubits[77], qubits[76] )
			yield cirq.TOFFOLI( qubits[50], qubits[69], qubits[52] )
			yield cirq.CNOT( qubits[49], qubits[37] )
			yield cirq.CNOT( qubits[61], qubits[44] )
			yield cirq.TOFFOLI( qubits[21], qubits[65], qubits[58] )
			yield cirq.CNOT( anc[0], qubits[51] )
			yield cirq.TOFFOLI( qubits[66], qubits[70], qubits[51] )
			yield cirq.CNOT( qubits[65], qubits[70] )
			yield cirq.TOFFOLI( qubits[13], qubits[11], qubits[32] )
			yield cirq.TOFFOLI( qubits[23], qubits[73], qubits[62] )
			yield cirq.CNOT( qubits[8], qubits[38] )
			yield cirq.TOFFOLI( qubits[60], qubits[70], qubits[67] )
			yield cirq.TOFFOLI( qubits[45], qubits[20], qubits[32] )
			yield cirq.TOFFOLI( qubits[25], qubits[45], qubits[39] )
			yield cirq.CNOT( qubits[66], qubits[10] )
			yield cirq.TOFFOLI( qubits[63], qubits[12], qubits[59] )
			yield cirq.TOFFOLI( qubits[18], qubits[7], qubits[26] )
			yield cirq.TOFFOLI( qubits[82], qubits[54], qubits[63] )
			yield cirq.CNOT( qubits[20], qubits[42] )
			yield cirq.CNOT( qubits[14], qubits[17] )
			yield cirq.TOFFOLI( qubits[23], qubits[37], qubits[30] )
			yield cirq.CNOT( qubits[72], qubits[71] )
			yield cirq.CNOT( qubits[25], qubits[49] )
			yield cirq.CNOT( qubits[10], qubits[58] )
			yield cirq.CNOT( qubits[77], qubits[20] )
			yield cirq.TOFFOLI( qubits[45], qubits[35], qubits[39] )
			yield cirq.TOFFOLI( qubits[6], qubits[54], qubits[11] )
			yield cirq.TOFFOLI( qubits[13], qubits[47], qubits[40] )
			yield cirq.TOFFOLI( qubits[81], qubits[46], qubits[28] )
			yield cirq.CNOT( qubits[8], qubits[57] )
			yield cirq.CNOT( qubits[63], qubits[7] )
			yield cirq.TOFFOLI( qubits[73], qubits[35], qubits[33] )
			yield cirq.TOFFOLI( qubits[28], qubits[14], anc[1] )
			yield cirq.CNOT( qubits[8], qubits[32] )
			yield cirq.CNOT( qubits[14], qubits[31] )
			yield cirq.CNOT( qubits[45], qubits[23] )
			yield cirq.CNOT( qubits[53], qubits[51] )
			yield cirq.CNOT( qubits[16], qubits[49] )
			yield cirq.TOFFOLI( anc[1], qubits[62], qubits[77] )
			yield cirq.TOFFOLI( qubits[22], qubits[82], qubits[20] )
			yield cirq.CNOT( qubits[0], qubits[41] )
			yield cirq.TOFFOLI( qubits[40], qubits[29], qubits[32] )
			yield cirq.CNOT( qubits[46], qubits[17] )
			yield cirq.CNOT( qubits[31], qubits[61] )
			yield cirq.TOFFOLI( qubits[56], qubits[57], qubits[37] )
			yield cirq.TOFFOLI( qubits[4], qubits[8], qubits[9] )
			yield cirq.CNOT( qubits[10], qubits[66] )
			yield cirq.TOFFOLI( qubits[70], qubits[17], anc[0] )
			yield cirq.CNOT( qubits[68], qubits[22] )
			yield cirq.TOFFOLI( qubits[79], qubits[50], qubits[45] )
			yield cirq.CNOT( qubits[79], qubits[73] )
			yield cirq.TOFFOLI( qubits[23], qubits[25], qubits[33] )
			yield cirq.CNOT( qubits[28], qubits[55] )
			yield cirq.TOFFOLI( qubits[65], qubits[0], qubits[13] )
			yield cirq.CNOT( qubits[12], qubits[77] )
			yield cirq.CNOT( qubits[58], qubits[7] )
			yield cirq.TOFFOLI( qubits[61], qubits[72], anc[0] )
			yield cirq.TOFFOLI( qubits[47], qubits[5], qubits[38] )
			yield cirq.CNOT( qubits[66], qubits[79] )
			yield cirq.TOFFOLI( qubits[52], qubits[56], qubits[62] )
			yield cirq.CNOT( qubits[22], qubits[44] )
			yield cirq.CNOT( qubits[44], qubits[78] )
			yield cirq.TOFFOLI( qubits[39], qubits[25], qubits[36] )
			yield cirq.CNOT( qubits[37], qubits[66] )
			yield cirq.CNOT( qubits[82], qubits[24] )
			yield cirq.CNOT( qubits[60], qubits[38] )
			yield cirq.TOFFOLI( qubits[2], qubits[50], qubits[35] )
			yield cirq.TOFFOLI( anc[1], qubits[28], qubits[40] )
			yield cirq.CNOT( qubits[37], qubits[6] )
			yield cirq.TOFFOLI( qubits[65], qubits[22], qubits[25] )
# Function 5 with degree 0
# nq: 29, na: 8, ng: 219
class Func5(cirq.Gate):
	def __init__(self, num_qubits, is_inverse=False):
		self._num_qubits = num_qubits
		self.is_inverse = is_inverse
	def num_qubits(self):
		return self._num_qubits
	def __pow__(self, power):
		if power == -1:
			return Func5(self._num_qubits, is_inverse=True)
		else:
			return NotImplemented
	def _decompose_(self, qubits):
		anc = qubits[29:] # ancilla
		res = [qubits[3], qubits[5], qubits[2], qubits[28], qubits[17], qubits[25], qubits[9], qubits[10], qubits[27], qubits[18], qubits[22], qubits[0], qubits[23], qubits[1], qubits[6], qubits[24], qubits[14], qubits[15], qubits[12], qubits[7], qubits[11], qubits[20], qubits[21], qubits[4], qubits[13]]
		# Leaf function
		if not self.is_inverse: 
			# Compute 
			yield cirq.TOFFOLI( anc[0], anc[2], qubits[1] )
			yield cirq.TOFFOLI( qubits[15], qubits[0], qubits[2] )
			yield cirq.TOFFOLI( qubits[24], qubits[9], anc[0] )
			yield cirq.CNOT( qubits[6], qubits[25] )
			yield cirq.CNOT( qubits[12], qubits[28] )
			yield cirq.CNOT( qubits[0], qubits[21] )
			yield cirq.CNOT( qubits[20], qubits[17] )
			yield cirq.CNOT( anc[6], qubits[15] )
			yield cirq.TOFFOLI( anc[7], anc[3], qubits[27] )
			yield cirq.TOFFOLI( anc[3], qubits[24], qubits[17] )
			yield cirq.CNOT( anc[7], anc[4] )
			yield cirq.TOFFOLI( anc[7], anc[4], qubits[4] )
			yield cirq.CNOT( qubits[5], qubits[27] )
			yield cirq.CNOT( qubits[27], qubits[1] )
			yield cirq.TOFFOLI( qubits[7], qubits[28], qubits[2] )
			yield cirq.CNOT( qubits[17], qubits[5] )
			yield cirq.CNOT( qubits[5], anc[0] )
			yield cirq.CNOT( qubits[3], anc[7] )
			yield cirq.CNOT( qubits[22], qubits[27] )
			yield cirq.TOFFOLI( qubits[13], qubits[27], qubits[19] )
			yield cirq.TOFFOLI( anc[5], anc[4], qubits[22] )
			yield cirq.CNOT( qubits[14], qubits[25] )
			yield cirq.CNOT( qubits[20], qubits[7] )
			yield cirq.TOFFOLI( qubits[28], qubits[2], qubits[25] )
			yield cirq.CNOT( qubits[22], qubits[4] )
			yield cirq.TOFFOLI( anc[0], qubits[5], anc[5] )
			yield cirq.TOFFOLI( qubits[9], anc[1], anc[4] )
			yield cirq.TOFFOLI( qubits[11], qubits[0], anc[3] )
			yield cirq.TOFFOLI( qubits[2], qubits[28], qubits[22] )
			yield cirq.TOFFOLI( qubits[14], qubits[13], qubits[18] )
			yield cirq.CNOT( qubits[18], qubits[27] )
			yield cirq.CNOT( qubits[6], qubits[14] )
			yield cirq.CNOT( anc[0], qubits[27] )
			yield cirq.CNOT( anc[4], qubits[26] )
			yield cirq.TOFFOLI( qubits[1], qubits[15], qubits[10] )
			yield cirq.TOFFOLI( qubits[10], qubits[19], qubits[28] )
			yield cirq.TOFFOLI( qubits[12], anc[3], qubits[13] )
			yield cirq.CNOT( qubits[19], qubits[8] )
			yield cirq.CNOT( qubits[26], qubits[11] )
			yield cirq.TOFFOLI( qubits[19], qubits[15], qubits[10] )
			yield cirq.TOFFOLI( qubits[8], qubits[10], qubits[20] )
			yield cirq.CNOT( qubits[20], qubits[10] )
			yield cirq.CNOT( qubits[17], anc[3] )
			yield cirq.TOFFOLI( qubits[16], anc[6], qubits[23] )
			yield cirq.TOFFOLI( anc[1], qubits[5], anc[0] )
			yield cirq.TOFFOLI( qubits[19], qubits[23], qubits[1] )
			yield cirq.TOFFOLI( qubits[5], anc[6], qubits[20] )
			yield cirq.TOFFOLI( qubits[21], qubits[4], qubits[18] )
			yield cirq.TOFFOLI( qubits[0], anc[1], qubits[20] )
			yield cirq.TOFFOLI( anc[6], qubits[26], qubits[24] )
			yield cirq.TOFFOLI( qubits[4], qubits[24], anc[2] )
			yield cirq.CNOT( qubits[2], qubits[13] )
			yield cirq.TOFFOLI( qubits[22], qubits[12], qubits[18] )
			yield cirq.CNOT( anc[1], qubits[28] )
			yield cirq.CNOT( anc[2], qubits[14] )
			yield cirq.CNOT( qubits[5], qubits[4] )
			yield cirq.TOFFOLI( qubits[8], qubits[0], qubits[5] )
			yield cirq.CNOT( qubits[1], qubits[11] )
			yield cirq.CNOT( anc[6], anc[7] )
			yield cirq.CNOT( qubits[20], qubits[15] )
			yield cirq.CNOT( anc[5], qubits[16] )
			yield cirq.TOFFOLI( anc[0], qubits[11], qubits[25] )
			yield cirq.CNOT( qubits[21], qubits[10] )
			yield cirq.CNOT( qubits[3], qubits[4] )
			yield cirq.CNOT( qubits[24], anc[2] )
			yield cirq.CNOT( qubits[18], anc[0] )
			yield cirq.CNOT( qubits[11], anc[6] )
			yield cirq.CNOT( qubits[15], qubits[18] )
			yield cirq.TOFFOLI( qubits[12], anc[1], anc[4] )
			yield cirq.TOFFOLI( qubits[2], qubits[24], anc[6] )
			yield cirq.CNOT( qubits[11], qubits[0] )
			yield cirq.CNOT( qubits[26], qubits[2] )
			yield cirq.TOFFOLI( qubits[3], qubits[22], qubits[5] )
			yield cirq.CNOT( qubits[7], qubits[25] )
			yield cirq.TOFFOLI( qubits[21], qubits[8], qubits[19] )
			yield cirq.CNOT( qubits[22], anc[4] )
			yield cirq.TOFFOLI( qubits[6], anc[4], qubits[12] )
			yield cirq.TOFFOLI( qubits[25], qubits[27], qubits[0] )
			yield cirq.CNOT( anc[2], qubits[15] )
			yield cirq.TOFFOLI( qubits[19], qubits[4], anc[2] )
			yield cirq.TOFFOLI( qubits[17], qubits[28], qubits[13] )
			yield cirq.CNOT( qubits[14], qubits[19] )
			yield cirq.CNOT( qubits[20], qubits[4] )
			yield cirq.TOFFOLI( qubits[15], qubits[6], qubits[1] )
			yield cirq.CNOT( qubits[28], qubits[15] )
			yield cirq.TOFFOLI( qubits[26], qubits[10], qubits[28] )
			yield cirq.TOFFOLI( qubits[19], qubits[12], qubits[2] )
			yield cirq.CNOT( qubits[11], anc[7] )
			yield cirq.TOFFOLI( qubits[5], qubits[0], qubits[2] )
			yield cirq.CNOT( anc[7], qubits[2] )
			yield cirq.CNOT( qubits[15], qubits[17] )
			yield cirq.CNOT( qubits[9], qubits[27] )
			yield cirq.CNOT( anc[4], anc[0] )
			yield cirq.TOFFOLI( qubits[10], qubits[19], qubits[11] )
			yield cirq.TOFFOLI( qubits[15], qubits[19], qubits[25] )
			yield cirq.CNOT( qubits[14], qubits[12] )
			yield cirq.CNOT( qubits[0], qubits[18] )
			yield cirq.CNOT( qubits[11], qubits[28] )
			yield cirq.CNOT( qubits[10], qubits[15] )
			yield cirq.TOFFOLI( qubits[12], qubits[13], qubits[19] )
			yield cirq.CNOT( qubits[28], qubits[11] )
			yield cirq.CNOT( qubits[0], qubits[19] )
			yield cirq.CNOT( qubits[12], qubits[22] )
			yield cirq.CNOT( qubits[8], anc[2] )
			yield cirq.CNOT( qubits[22], qubits[4] )
			yield cirq.TOFFOLI( qubits[9], qubits[21], anc[1] )
			yield cirq.CNOT( anc[6], qubits[24] )
			yield cirq.TOFFOLI( anc[6], anc[5], qubits[21] )
			yield cirq.TOFFOLI( qubits[14], qubits[9], anc[2] )
			yield cirq.CNOT( qubits[7], anc[0] )
			yield cirq.TOFFOLI( anc[3], qubits[1], qubits[10] )
			yield cirq.TOFFOLI( qubits[24], qubits[2], anc[7] )
			yield cirq.TOFFOLI( qubits[10], qubits[8], anc[7] )
			yield cirq.CNOT( anc[5], anc[2] )
			yield cirq.CNOT( qubits[24], qubits[17] )
			yield cirq.CNOT( qubits[20], anc[2] )
			yield cirq.CNOT( qubits[9], qubits[15] )
			yield cirq.CNOT( qubits[1], qubits[8] )
			yield cirq.TOFFOLI( qubits[13], qubits[1], anc[4] )
			yield cirq.TOFFOLI( qubits[19], qubits[5], qubits[8] )
			yield cirq.TOFFOLI( qubits[7], qubits[8], anc[6] )
			yield cirq.CNOT( qubits[28], qubits[15] )
			yield cirq.TOFFOLI( anc[6], qubits[17], qubits[19] )
			yield cirq.TOFFOLI( qubits[22], qubits[0], qubits[26] )
			yield cirq.CNOT( qubits[15], qubits[28] )
			yield cirq.CNOT( qubits[18], qubits[16] )
			yield cirq.CNOT( anc[1], qubits[8] )
			yield cirq.TOFFOLI( qubits[1], anc[6], qubits[4] )
			yield cirq.TOFFOLI( qubits[17], qubits[1], qubits[5] )
			yield cirq.TOFFOLI( qubits[4], qubits[7], qubits[28] )
			yield cirq.CNOT( qubits[19], qubits[4] )
			yield cirq.CNOT( qubits[11], anc[5] )
			yield cirq.CNOT( qubits[17], qubits[18] )
			yield cirq.TOFFOLI( qubits[8], qubits[20], qubits[25] )
			yield cirq.CNOT( qubits[0], anc[2] )
			yield cirq.CNOT( qubits[5], anc[6] )
			yield cirq.CNOT( qubits[22], qubits[8] )
			yield cirq.TOFFOLI( qubits[23], qubits[13], qubits[5] )
			yield cirq.CNOT( qubits[28], anc[2] )
			yield cirq.TOFFOLI( qubits[2], anc[1], qubits[20] )
			yield cirq.TOFFOLI( qubits[2], qubits[25], qubits[13] )
			yield cirq.CNOT( qubits[25], qubits[9] )
			yield cirq.TOFFOLI( qubits[11], anc[4], anc[7] )
			yield cirq.CNOT( qubits[16], qubits[28] )
			yield cirq.CNOT( qubits[20], qubits[24] )
			yield cirq.CNOT( anc[4], anc[5] )
			yield cirq.CNOT( qubits[17], qubits[5] )
			yield cirq.TOFFOLI( qubits[6], qubits[20], qubits[28] )
			yield cirq.TOFFOLI( qubits[10], qubits[19], qubits[6] )
			yield cirq.CNOT( qubits[4], qubits[8] )
			yield cirq.TOFFOLI( qubits[6], qubits[0], qubits[9] )
			yield cirq.CNOT( qubits[5], qubits[8] )
			yield cirq.TOFFOLI( qubits[17], qubits[18], anc[4] )
			yield cirq.CNOT( qubits[26], qubits[11] )
			yield cirq.TOFFOLI( qubits[9], qubits[11], qubits[0] )
			yield cirq.CNOT( qubits[7], qubits[26] )
			yield cirq.TOFFOLI( anc[4], anc[7], qubits[24] )
			yield cirq.CNOT( qubits[5], qubits[6] )
			yield cirq.TOFFOLI( anc[2], anc[5], qubits[0] )
			yield cirq.CNOT( qubits[6], qubits[19] )
			yield cirq.TOFFOLI( anc[2], qubits[24], anc[4] )
			yield cirq.TOFFOLI( anc[5], qubits[1], qubits[27] )
			yield cirq.CNOT( anc[4], qubits[1] )
			yield cirq.CNOT( qubits[13], qubits[26] )
			yield cirq.TOFFOLI( qubits[25], qubits[19], anc[2] )
			yield cirq.CNOT( qubits[13], qubits[5] )
			yield cirq.TOFFOLI( qubits[9], qubits[24], qubits[2] )
			yield cirq.TOFFOLI( anc[0], anc[1], qubits[7] )
			yield cirq.CNOT( anc[2], qubits[22] )
			yield cirq.TOFFOLI( qubits[21], anc[0], qubits[22] )
			yield cirq.CNOT( qubits[13], qubits[16] )
			yield cirq.CNOT( qubits[9], anc[1] )
			yield cirq.TOFFOLI( anc[0], qubits[14], qubits[22] )
			yield cirq.CNOT( qubits[4], qubits[8] )
			yield cirq.CNOT( qubits[21], anc[5] )
			yield cirq.TOFFOLI( qubits[3], qubits[13], qubits[10] )
			yield cirq.TOFFOLI( qubits[2], qubits[12], qubits[28] )
			yield cirq.TOFFOLI( qubits[7], qubits[1], qubits[24] )
			yield cirq.CNOT( qubits[10], anc[2] )
			yield cirq.TOFFOLI( qubits[8], qubits[19], qubits[27] )
			yield cirq.TOFFOLI( qubits[18], qubits[24], qubits[1] )
			yield cirq.TOFFOLI( anc[4], qubits[0], qubits[6] )
			yield cirq.TOFFOLI( qubits[24], anc[1], qubits[25] )
			yield cirq.CNOT( qubits[17], anc[6] )
			yield cirq.TOFFOLI( qubits[0], qubits[22], qubits[19] )
			yield cirq.CNOT( qubits[3], qubits[13] )
			yield cirq.CNOT( qubits[3], qubits[28] )
			yield cirq.CNOT( anc[3], qubits[22] )
			yield cirq.TOFFOLI( anc[4], qubits[28], qubits[15] )
			yield cirq.TOFFOLI( anc[7], qubits[26], qubits[27] )
			yield cirq.TOFFOLI( qubits[0], qubits[27], qubits[2] )
			yield cirq.TOFFOLI( qubits[17], qubits[18], qubits[11] )
			yield cirq.CNOT( qubits[3], qubits[18] )
			yield cirq.CNOT( qubits[15], anc[4] )
			yield cirq.TOFFOLI( qubits[0], qubits[4], qubits[3] )
			yield cirq.TOFFOLI( qubits[17], anc[5], qubits[12] )
			yield cirq.TOFFOLI( anc[1], qubits[13], qubits[5] )
			yield cirq.CNOT( qubits[26], qubits[22] )
			yield cirq.CNOT( qubits[9], anc[0] )
			yield cirq.TOFFOLI( anc[6], anc[2], qubits[12] )
			yield cirq.TOFFOLI( qubits[10], qubits[27], qubits[13] )
			yield cirq.CNOT( qubits[10], qubits[2] )
			yield cirq.TOFFOLI( qubits[25], qubits[11], qubits[19] )
			yield cirq.CNOT( qubits[1], qubits[8] )
			yield cirq.TOFFOLI( qubits[21], qubits[2], qubits[22] )
			yield cirq.CNOT( qubits[13], anc[7] )
			yield cirq.CNOT( qubits[17], qubits[12] )
			yield cirq.TOFFOLI( qubits[8], anc[4], qubits[0] )
			yield cirq.TOFFOLI( qubits[25], qubits[22], anc[3] )
			yield cirq.TOFFOLI( anc[4], qubits[11], qubits[10] )
			yield cirq.CNOT( qubits[4], qubits[3] )
			yield cirq.TOFFOLI( qubits[7], qubits[24], qubits[2] )
			yield cirq.CNOT( qubits[23], qubits[13] )
			yield cirq.TOFFOLI( qubits[27], qubits[1], qubits[18] )
			yield cirq.CNOT( qubits[21], qubits[28] )
			yield cirq.TOFFOLI( qubits[9], qubits[25], qubits[13] )
			yield cirq.TOFFOLI( anc[5], qubits[18], qubits[2] )
			yield cirq.TOFFOLI( qubits[24], qubits[17], qubits[15] )
			yield cirq.TOFFOLI( anc[6], qubits[7], qubits[28] )
			# Store 
			# Note: this version does not store results.
		else: 
			# Uncompute 
			yield cirq.TOFFOLI( anc[6], qubits[7], qubits[28] )
			yield cirq.TOFFOLI( qubits[24], qubits[17], qubits[15] )
			yield cirq.TOFFOLI( anc[5], qubits[18], qubits[2] )
			yield cirq.TOFFOLI( qubits[9], qubits[25], qubits[13] )
			yield cirq.CNOT( qubits[21], qubits[28] )
			yield cirq.TOFFOLI( qubits[27], qubits[1], qubits[18] )
			yield cirq.CNOT( qubits[23], qubits[13] )
			yield cirq.TOFFOLI( qubits[7], qubits[24], qubits[2] )
			yield cirq.CNOT( qubits[4], qubits[3] )
			yield cirq.TOFFOLI( anc[4], qubits[11], qubits[10] )
			yield cirq.TOFFOLI( qubits[25], qubits[22], anc[3] )
			yield cirq.TOFFOLI( qubits[8], anc[4], qubits[0] )
			yield cirq.CNOT( qubits[17], qubits[12] )
			yield cirq.CNOT( qubits[13], anc[7] )
			yield cirq.TOFFOLI( qubits[21], qubits[2], qubits[22] )
			yield cirq.CNOT( qubits[1], qubits[8] )
			yield cirq.TOFFOLI( qubits[25], qubits[11], qubits[19] )
			yield cirq.CNOT( qubits[10], qubits[2] )
			yield cirq.TOFFOLI( qubits[10], qubits[27], qubits[13] )
			yield cirq.TOFFOLI( anc[6], anc[2], qubits[12] )
			yield cirq.CNOT( qubits[9], anc[0] )
			yield cirq.CNOT( qubits[26], qubits[22] )
			yield cirq.TOFFOLI( anc[1], qubits[13], qubits[5] )
			yield cirq.TOFFOLI( qubits[17], anc[5], qubits[12] )
			yield cirq.TOFFOLI( qubits[0], qubits[4], qubits[3] )
			yield cirq.CNOT( qubits[15], anc[4] )
			yield cirq.CNOT( qubits[3], qubits[18] )
			yield cirq.TOFFOLI( qubits[17], qubits[18], qubits[11] )
			yield cirq.TOFFOLI( qubits[0], qubits[27], qubits[2] )
			yield cirq.TOFFOLI( anc[7], qubits[26], qubits[27] )
			yield cirq.TOFFOLI( anc[4], qubits[28], qubits[15] )
			yield cirq.CNOT( anc[3], qubits[22] )
			yield cirq.CNOT( qubits[3], qubits[28] )
			yield cirq.CNOT( qubits[3], qubits[13] )
			yield cirq.TOFFOLI( qubits[0], qubits[22], qubits[19] )
			yield cirq.CNOT( qubits[17], anc[6] )
			yield cirq.TOFFOLI( qubits[24], anc[1], qubits[25] )
			yield cirq.TOFFOLI( anc[4], qubits[0], qubits[6] )
			yield cirq.TOFFOLI( qubits[18], qubits[24], qubits[1] )
			yield cirq.TOFFOLI( qubits[8], qubits[19], qubits[27] )
			yield cirq.CNOT( qubits[10], anc[2] )
			yield cirq.TOFFOLI( qubits[7], qubits[1], qubits[24] )
			yield cirq.TOFFOLI( qubits[2], qubits[12], qubits[28] )
			yield cirq.TOFFOLI( qubits[3], qubits[13], qubits[10] )
			yield cirq.CNOT( qubits[21], anc[5] )
			yield cirq.CNOT( qubits[4], qubits[8] )
			yield cirq.TOFFOLI( anc[0], qubits[14], qubits[22] )
			yield cirq.CNOT( qubits[9], anc[1] )
			yield cirq.CNOT( qubits[13], qubits[16] )
			yield cirq.TOFFOLI( qubits[21], anc[0], qubits[22] )
			yield cirq.CNOT( anc[2], qubits[22] )
			yield cirq.TOFFOLI( anc[0], anc[1], qubits[7] )
			yield cirq.TOFFOLI( qubits[9], qubits[24], qubits[2] )
			yield cirq.CNOT( qubits[13], qubits[5] )
			yield cirq.TOFFOLI( qubits[25], qubits[19], anc[2] )
			yield cirq.CNOT( qubits[13], qubits[26] )
			yield cirq.CNOT( anc[4], qubits[1] )
			yield cirq.TOFFOLI( anc[5], qubits[1], qubits[27] )
			yield cirq.TOFFOLI( anc[2], qubits[24], anc[4] )
			yield cirq.CNOT( qubits[6], qubits[19] )
			yield cirq.TOFFOLI( anc[2], anc[5], qubits[0] )
			yield cirq.CNOT( qubits[5], qubits[6] )
			yield cirq.TOFFOLI( anc[4], anc[7], qubits[24] )
			yield cirq.CNOT( qubits[7], qubits[26] )
			yield cirq.TOFFOLI( qubits[9], qubits[11], qubits[0] )
			yield cirq.CNOT( qubits[26], qubits[11] )
			yield cirq.TOFFOLI( qubits[17], qubits[18], anc[4] )
			yield cirq.CNOT( qubits[5], qubits[8] )
			yield cirq.TOFFOLI( qubits[6], qubits[0], qubits[9] )
			yield cirq.CNOT( qubits[4], qubits[8] )
			yield cirq.TOFFOLI( qubits[10], qubits[19], qubits[6] )
			yield cirq.TOFFOLI( qubits[6], qubits[20], qubits[28] )
			yield cirq.CNOT( qubits[17], qubits[5] )
			yield cirq.CNOT( anc[4], anc[5] )
			yield cirq.CNOT( qubits[20], qubits[24] )
			yield cirq.CNOT( qubits[16], qubits[28] )
			yield cirq.TOFFOLI( qubits[11], anc[4], anc[7] )
			yield cirq.CNOT( qubits[25], qubits[9] )
			yield cirq.TOFFOLI( qubits[2], qubits[25], qubits[13] )
			yield cirq.TOFFOLI( qubits[2], anc[1], qubits[20] )
			yield cirq.CNOT( qubits[28], anc[2] )
			yield cirq.TOFFOLI( qubits[23], qubits[13], qubits[5] )
			yield cirq.CNOT( qubits[22], qubits[8] )
			yield cirq.CNOT( qubits[5], anc[6] )
			yield cirq.CNOT( qubits[0], anc[2] )
			yield cirq.TOFFOLI( qubits[8], qubits[20], qubits[25] )
			yield cirq.CNOT( qubits[17], qubits[18] )
			yield cirq.CNOT( qubits[11], anc[5] )
			yield cirq.CNOT( qubits[19], qubits[4] )
			yield cirq.TOFFOLI( qubits[4], qubits[7], qubits[28] )
			yield cirq.TOFFOLI( qubits[17], qubits[1], qubits[5] )
			yield cirq.TOFFOLI( qubits[1], anc[6], qubits[4] )
			yield cirq.CNOT( anc[1], qubits[8] )
			yield cirq.CNOT( qubits[18], qubits[16] )
			yield cirq.CNOT( qubits[15], qubits[28] )
			yield cirq.TOFFOLI( qubits[22], qubits[0], qubits[26] )
			yield cirq.TOFFOLI( anc[6], qubits[17], qubits[19] )
			yield cirq.CNOT( qubits[28], qubits[15] )
			yield cirq.TOFFOLI( qubits[7], qubits[8], anc[6] )
			yield cirq.TOFFOLI( qubits[19], qubits[5], qubits[8] )
			yield cirq.TOFFOLI( qubits[13], qubits[1], anc[4] )
			yield cirq.CNOT( qubits[1], qubits[8] )
			yield cirq.CNOT( qubits[9], qubits[15] )
			yield cirq.CNOT( qubits[20], anc[2] )
			yield cirq.CNOT( qubits[24], qubits[17] )
			yield cirq.CNOT( anc[5], anc[2] )
			yield cirq.TOFFOLI( qubits[10], qubits[8], anc[7] )
			yield cirq.TOFFOLI( qubits[24], qubits[2], anc[7] )
			yield cirq.TOFFOLI( anc[3], qubits[1], qubits[10] )
			yield cirq.CNOT( qubits[7], anc[0] )
			yield cirq.TOFFOLI( qubits[14], qubits[9], anc[2] )
			yield cirq.TOFFOLI( anc[6], anc[5], qubits[21] )
			yield cirq.CNOT( anc[6], qubits[24] )
			yield cirq.TOFFOLI( qubits[9], qubits[21], anc[1] )
			yield cirq.CNOT( qubits[22], qubits[4] )
			yield cirq.CNOT( qubits[8], anc[2] )
			yield cirq.CNOT( qubits[12], qubits[22] )
			yield cirq.CNOT( qubits[0], qubits[19] )
			yield cirq.CNOT( qubits[28], qubits[11] )
			yield cirq.TOFFOLI( qubits[12], qubits[13], qubits[19] )
			yield cirq.CNOT( qubits[10], qubits[15] )
			yield cirq.CNOT( qubits[11], qubits[28] )
			yield cirq.CNOT( qubits[0], qubits[18] )
			yield cirq.CNOT( qubits[14], qubits[12] )
			yield cirq.TOFFOLI( qubits[15], qubits[19], qubits[25] )
			yield cirq.TOFFOLI( qubits[10], qubits[19], qubits[11] )
			yield cirq.CNOT( anc[4], anc[0] )
			yield cirq.CNOT( qubits[9], qubits[27] )
			yield cirq.CNOT( qubits[15], qubits[17] )
			yield cirq.CNOT( anc[7], qubits[2] )
			yield cirq.TOFFOLI( qubits[5], qubits[0], qubits[2] )
			yield cirq.CNOT( qubits[11], anc[7] )
			yield cirq.TOFFOLI( qubits[19], qubits[12], qubits[2] )
			yield cirq.TOFFOLI( qubits[26], qubits[10], qubits[28] )
			yield cirq.CNOT( qubits[28], qubits[15] )
			yield cirq.TOFFOLI( qubits[15], qubits[6], qubits[1] )
			yield cirq.CNOT( qubits[20], qubits[4] )
			yield cirq.CNOT( qubits[14], qubits[19] )
			yield cirq.TOFFOLI( qubits[17], qubits[28], qubits[13] )
			yield cirq.TOFFOLI( qubits[19], qubits[4], anc[2] )
			yield cirq.CNOT( anc[2], qubits[15] )
			yield cirq.TOFFOLI( qubits[25], qubits[27], qubits[0] )
			yield cirq.TOFFOLI( qubits[6], anc[4], qubits[12] )
			yield cirq.CNOT( qubits[22], anc[4] )
			yield cirq.TOFFOLI( qubits[21], qubits[8], qubits[19] )
			yield cirq.CNOT( qubits[7], qubits[25] )
			yield cirq.TOFFOLI( qubits[3], qubits[22], qubits[5] )
			yield cirq.CNOT( qubits[26], qubits[2] )
			yield cirq.CNOT( qubits[11], qubits[0] )
			yield cirq.TOFFOLI( qubits[2], qubits[24], anc[6] )
			yield cirq.TOFFOLI( qubits[12], anc[1], anc[4] )
			yield cirq.CNOT( qubits[15], qubits[18] )
			yield cirq.CNOT( qubits[11], anc[6] )
			yield cirq.CNOT( qubits[18], anc[0] )
			yield cirq.CNOT( qubits[24], anc[2] )
			yield cirq.CNOT( qubits[3], qubits[4] )
			yield cirq.CNOT( qubits[21], qubits[10] )
			yield cirq.TOFFOLI( anc[0], qubits[11], qubits[25] )
			yield cirq.CNOT( anc[5], qubits[16] )
			yield cirq.CNOT( qubits[20], qubits[15] )
			yield cirq.CNOT( anc[6], anc[7] )
			yield cirq.CNOT( qubits[1], qubits[11] )
			yield cirq.TOFFOLI( qubits[8], qubits[0], qubits[5] )
			yield cirq.CNOT( qubits[5], qubits[4] )
			yield cirq.CNOT( anc[2], qubits[14] )
			yield cirq.CNOT( anc[1], qubits[28] )
			yield cirq.TOFFOLI( qubits[22], qubits[12], qubits[18] )
			yield cirq.CNOT( qubits[2], qubits[13] )
			yield cirq.TOFFOLI( qubits[4], qubits[24], anc[2] )
			yield cirq.TOFFOLI( anc[6], qubits[26], qubits[24] )
			yield cirq.TOFFOLI( qubits[0], anc[1], qubits[20] )
			yield cirq.TOFFOLI( qubits[21], qubits[4], qubits[18] )
			yield cirq.TOFFOLI( qubits[5], anc[6], qubits[20] )
			yield cirq.TOFFOLI( qubits[19], qubits[23], qubits[1] )
			yield cirq.TOFFOLI( anc[1], qubits[5], anc[0] )
			yield cirq.TOFFOLI( qubits[16], anc[6], qubits[23] )
			yield cirq.CNOT( qubits[17], anc[3] )
			yield cirq.CNOT( qubits[20], qubits[10] )
			yield cirq.TOFFOLI( qubits[8], qubits[10], qubits[20] )
			yield cirq.TOFFOLI( qubits[19], qubits[15], qubits[10] )
			yield cirq.CNOT( qubits[26], qubits[11] )
			yield cirq.CNOT( qubits[19], qubits[8] )
			yield cirq.TOFFOLI( qubits[12], anc[3], qubits[13] )
			yield cirq.TOFFOLI( qubits[10], qubits[19], qubits[28] )
			yield cirq.TOFFOLI( qubits[1], qubits[15], qubits[10] )
			yield cirq.CNOT( anc[4], qubits[26] )
			yield cirq.CNOT( anc[0], qubits[27] )
			yield cirq.CNOT( qubits[6], qubits[14] )
			yield cirq.CNOT( qubits[18], qubits[27] )
			yield cirq.TOFFOLI( qubits[14], qubits[13], qubits[18] )
			yield cirq.TOFFOLI( qubits[2], qubits[28], qubits[22] )
			yield cirq.TOFFOLI( qubits[11], qubits[0], anc[3] )
			yield cirq.TOFFOLI( qubits[9], anc[1], anc[4] )
			yield cirq.TOFFOLI( anc[0], qubits[5], anc[5] )
			yield cirq.CNOT( qubits[22], qubits[4] )
			yield cirq.TOFFOLI( qubits[28], qubits[2], qubits[25] )
			yield cirq.CNOT( qubits[20], qubits[7] )
			yield cirq.CNOT( qubits[14], qubits[25] )
			yield cirq.TOFFOLI( anc[5], anc[4], qubits[22] )
			yield cirq.TOFFOLI( qubits[13], qubits[27], qubits[19] )
			yield cirq.CNOT( qubits[22], qubits[27] )
			yield cirq.CNOT( qubits[3], anc[7] )
			yield cirq.CNOT( qubits[5], anc[0] )
			yield cirq.CNOT( qubits[17], qubits[5] )
			yield cirq.TOFFOLI( qubits[7], qubits[28], qubits[2] )
			yield cirq.CNOT( qubits[27], qubits[1] )
			yield cirq.CNOT( qubits[5], qubits[27] )
			yield cirq.TOFFOLI( anc[7], anc[4], qubits[4] )
			yield cirq.CNOT( anc[7], anc[4] )
			yield cirq.TOFFOLI( anc[3], qubits[24], qubits[17] )
			yield cirq.TOFFOLI( anc[7], anc[3], qubits[27] )
			yield cirq.CNOT( anc[6], qubits[15] )
			yield cirq.CNOT( qubits[20], qubits[17] )
			yield cirq.CNOT( qubits[0], qubits[21] )
			yield cirq.CNOT( qubits[12], qubits[28] )
			yield cirq.CNOT( qubits[6], qubits[25] )
			yield cirq.TOFFOLI( qubits[24], qubits[9], anc[0] )
			yield cirq.TOFFOLI( qubits[15], qubits[0], qubits[2] )
			yield cirq.TOFFOLI( anc[0], anc[2], qubits[1] )
# Function 4 with degree 0
# nq: 110, na: 2, ng: 3
class Func4(cirq.Gate):
	def __init__(self, num_qubits, is_inverse=False):
		self._num_qubits = num_qubits
		self.is_inverse = is_inverse
	def num_qubits(self):
		return self._num_qubits
	def __pow__(self, power):
		if power == -1:
			return Func4(self._num_qubits, is_inverse=True)
		else:
			return NotImplemented
	def _decompose_(self, qubits):
		anc = qubits[110:] # ancilla
		res = [qubits[23], qubits[70], qubits[97], qubits[101], qubits[19], qubits[73], qubits[83], qubits[98], qubits[103], qubits[10], qubits[66], qubits[77], qubits[21], qubits[41], qubits[33], qubits[14], qubits[3], qubits[35], qubits[63], qubits[5], qubits[69], qubits[48], qubits[11], qubits[84], qubits[13], qubits[40], qubits[96], qubits[58], qubits[61], qubits[74], qubits[51], qubits[7], qubits[8], qubits[27], qubits[79], qubits[47], qubits[44], qubits[76]]
		# Leaf function
		if not self.is_inverse: 
			# Compute 
			yield cirq.CNOT( qubits[103], qubits[3] )
			yield cirq.TOFFOLI( qubits[46], qubits[71], qubits[102] )
			yield cirq.CNOT( qubits[98], qubits[30] )
			# Store 
			# Note: this version does not store results.
		else: 
			# Uncompute 
			yield cirq.CNOT( qubits[98], qubits[30] )
			yield cirq.TOFFOLI( qubits[46], qubits[71], qubits[102] )
			yield cirq.CNOT( qubits[103], qubits[3] )
# Function 3 with degree 0
# nq: 120, na: 6, ng: 48
class Func3(cirq.Gate):
	def __init__(self, num_qubits, is_inverse=False):
		self._num_qubits = num_qubits
		self.is_inverse = is_inverse
	def num_qubits(self):
		return self._num_qubits
	def __pow__(self, power):
		if power == -1:
			return Func3(self._num_qubits, is_inverse=True)
		else:
			return NotImplemented
	def _decompose_(self, qubits):
		anc = qubits[120:] # ancilla
		res = [qubits[90], qubits[71], qubits[110], qubits[8], qubits[92], qubits[9], qubits[4], qubits[21], qubits[31], qubits[37], qubits[16], qubits[0], qubits[22], qubits[107], qubits[98], qubits[104], qubits[80], qubits[119], qubits[101], qubits[3], qubits[18], qubits[6], qubits[40], qubits[53], qubits[96], qubits[94], qubits[108], qubits[17], qubits[28], qubits[84], qubits[13], qubits[68], qubits[81], qubits[88], qubits[33], qubits[39], qubits[62], qubits[83], qubits[73], qubits[5], qubits[49], qubits[41], qubits[51], qubits[52], qubits[50], qubits[36], qubits[46], qubits[63], qubits[34], qubits[65], qubits[44], qubits[100], qubits[66], qubits[89], qubits[75], qubits[72], qubits[32], qubits[97], qubits[87], qubits[76], qubits[38], qubits[10], qubits[109], qubits[61], qubits[23], qubits[78], qubits[20], qubits[42], qubits[12], qubits[116], qubits[105], qubits[24], qubits[58], qubits[11], qubits[30], qubits[95], qubits[113], qubits[79], qubits[15], qubits[43], qubits[85], qubits[27], qubits[26], qubits[56], qubits[35], qubits[99], qubits[106], qubits[118], qubits[111], qubits[55], qubits[69], qubits[82], qubits[117], qubits[57], qubits[114], qubits[45], qubits[54], qubits[47], qubits[77], qubits[103], qubits[70], qubits[93], qubits[91], qubits[7], qubits[14], qubits[48], qubits[29], qubits[60], qubits[19], qubits[67], qubits[1], qubits[102], qubits[25], qubits[115], qubits[2], qubits[74], qubits[64]]
		# Leaf function
		if not self.is_inverse: 
			# Compute 
			yield cirq.TOFFOLI( qubits[76], qubits[71], qubits[92] )
			yield cirq.CNOT( qubits[36], qubits[59] )
			yield cirq.CNOT( qubits[73], qubits[86] )
			yield cirq.TOFFOLI( qubits[95], qubits[45], qubits[27] )
			yield cirq.CNOT( qubits[61], qubits[100] )
			yield cirq.CNOT( qubits[66], qubits[12] )
			yield cirq.TOFFOLI( qubits[21], qubits[20], qubits[65] )
			yield cirq.CNOT( qubits[96], qubits[116] )
			yield cirq.TOFFOLI( qubits[76], qubits[117], qubits[55] )
			yield cirq.TOFFOLI( qubits[97], qubits[15], qubits[108] )
			yield cirq.TOFFOLI( qubits[90], qubits[106], qubits[83] )
			yield cirq.CNOT( qubits[74], anc[5] )
			yield cirq.TOFFOLI( qubits[88], qubits[92], qubits[56] )
			yield cirq.TOFFOLI( qubits[23], qubits[81], qubits[101] )
			yield cirq.CNOT( qubits[30], anc[0] )
			yield cirq.CNOT( qubits[20], qubits[0] )
			yield cirq.TOFFOLI( qubits[74], qubits[99], qubits[42] )
			yield cirq.CNOT( qubits[40], qubits[61] )
			yield cirq.CNOT( qubits[100], qubits[12] )
			yield cirq.CNOT( qubits[54], qubits[72] )
			yield cirq.CNOT( qubits[52], qubits[51] )
			yield cirq.TOFFOLI( qubits[74], qubits[34], qubits[55] )
			yield cirq.CNOT( qubits[5], qubits[109] )
			yield cirq.TOFFOLI( qubits[52], qubits[106], qubits[11] )
			yield cirq.TOFFOLI( qubits[40], qubits[112], qubits[97] )
			yield cirq.TOFFOLI( qubits[2], qubits[96], qubits[44] )
			yield cirq.CNOT( qubits[60], qubits[27] )
			yield cirq.CNOT( qubits[19], qubits[46] )
			yield cirq.CNOT( qubits[94], qubits[20] )
			yield cirq.TOFFOLI( qubits[33], qubits[38], qubits[54] )
			yield cirq.TOFFOLI( qubits[97], qubits[69], qubits[56] )
			yield cirq.TOFFOLI( qubits[46], qubits[53], qubits[14] )
			yield cirq.CNOT( anc[3], qubits[105] )
			yield cirq.CNOT( anc[1], qubits[88] )
			yield cirq.TOFFOLI( qubits[49], qubits[107], qubits[82] )
			yield cirq.TOFFOLI( qubits[63], qubits[101], qubits[65] )
			yield cirq.CNOT( qubits[119], qubits[79] )
			yield cirq.CNOT( qubits[73], qubits[12] )
			yield cirq.TOFFOLI( qubits[16], qubits[64], qubits[108] )
			yield cirq.CNOT( anc[4], qubits[2] )
			yield cirq.TOFFOLI( qubits[50], qubits[51], qubits[4] )
			yield cirq.TOFFOLI( qubits[71], qubits[96], qubits[65] )
			yield cirq.TOFFOLI( qubits[107], qubits[24], qubits[74] )
			yield cirq.TOFFOLI( anc[0], qubits[32], qubits[112] )
			yield cirq.TOFFOLI( anc[0], qubits[119], anc[3] )
			yield cirq.CNOT( qubits[23], qubits[103] )
			yield cirq.TOFFOLI( qubits[2], qubits[99], anc[2] )
			yield cirq.CNOT( qubits[73], qubits[94] )
			# Store 
			# Note: this version does not store results.
		else: 
			# Uncompute 
			yield cirq.CNOT( qubits[73], qubits[94] )
			yield cirq.TOFFOLI( qubits[2], qubits[99], anc[2] )
			yield cirq.CNOT( qubits[23], qubits[103] )
			yield cirq.TOFFOLI( anc[0], qubits[119], anc[3] )
			yield cirq.TOFFOLI( anc[0], qubits[32], qubits[112] )
			yield cirq.TOFFOLI( qubits[107], qubits[24], qubits[74] )
			yield cirq.TOFFOLI( qubits[71], qubits[96], qubits[65] )
			yield cirq.TOFFOLI( qubits[50], qubits[51], qubits[4] )
			yield cirq.CNOT( anc[4], qubits[2] )
			yield cirq.TOFFOLI( qubits[16], qubits[64], qubits[108] )
			yield cirq.CNOT( qubits[73], qubits[12] )
			yield cirq.CNOT( qubits[119], qubits[79] )
			yield cirq.TOFFOLI( qubits[63], qubits[101], qubits[65] )
			yield cirq.TOFFOLI( qubits[49], qubits[107], qubits[82] )
			yield cirq.CNOT( anc[1], qubits[88] )
			yield cirq.CNOT( anc[3], qubits[105] )
			yield cirq.TOFFOLI( qubits[46], qubits[53], qubits[14] )
			yield cirq.TOFFOLI( qubits[97], qubits[69], qubits[56] )
			yield cirq.TOFFOLI( qubits[33], qubits[38], qubits[54] )
			yield cirq.CNOT( qubits[94], qubits[20] )
			yield cirq.CNOT( qubits[19], qubits[46] )
			yield cirq.CNOT( qubits[60], qubits[27] )
			yield cirq.TOFFOLI( qubits[2], qubits[96], qubits[44] )
			yield cirq.TOFFOLI( qubits[40], qubits[112], qubits[97] )
			yield cirq.TOFFOLI( qubits[52], qubits[106], qubits[11] )
			yield cirq.CNOT( qubits[5], qubits[109] )
			yield cirq.TOFFOLI( qubits[74], qubits[34], qubits[55] )
			yield cirq.CNOT( qubits[52], qubits[51] )
			yield cirq.CNOT( qubits[54], qubits[72] )
			yield cirq.CNOT( qubits[100], qubits[12] )
			yield cirq.CNOT( qubits[40], qubits[61] )
			yield cirq.TOFFOLI( qubits[74], qubits[99], qubits[42] )
			yield cirq.CNOT( qubits[20], qubits[0] )
			yield cirq.CNOT( qubits[30], anc[0] )
			yield cirq.TOFFOLI( qubits[23], qubits[81], qubits[101] )
			yield cirq.TOFFOLI( qubits[88], qubits[92], qubits[56] )
			yield cirq.CNOT( qubits[74], anc[5] )
			yield cirq.TOFFOLI( qubits[90], qubits[106], qubits[83] )
			yield cirq.TOFFOLI( qubits[97], qubits[15], qubits[108] )
			yield cirq.TOFFOLI( qubits[76], qubits[117], qubits[55] )
			yield cirq.CNOT( qubits[96], qubits[116] )
			yield cirq.TOFFOLI( qubits[21], qubits[20], qubits[65] )
			yield cirq.CNOT( qubits[66], qubits[12] )
			yield cirq.CNOT( qubits[61], qubits[100] )
			yield cirq.TOFFOLI( qubits[95], qubits[45], qubits[27] )
			yield cirq.CNOT( qubits[73], qubits[86] )
			yield cirq.CNOT( qubits[36], qubits[59] )
			yield cirq.TOFFOLI( qubits[76], qubits[71], qubits[92] )
# Function 2 with degree 2
# nq: 128, na: 8, ng: 114
class Func2(cirq.Gate):
	def __init__(self, num_qubits, is_inverse=False):
		self._num_qubits = num_qubits
		self.is_inverse = is_inverse
	def num_qubits(self):
		return self._num_qubits
	def __pow__(self, power):
		if power == -1:
			return Func2(self._num_qubits, is_inverse=True)
		else:
			return NotImplemented
	def _decompose_(self, qubits):
		anc = qubits[128:] # ancilla
		res = [qubits[8], qubits[96], qubits[127], qubits[95], qubits[9], qubits[40], qubits[49], qubits[22], qubits[25], qubits[88], qubits[125], qubits[116], qubits[60], qubits[50], qubits[36], qubits[83], qubits[51], qubits[117], qubits[114], qubits[103], qubits[107], qubits[106], qubits[67], qubits[68], qubits[102], qubits[58], qubits[98], qubits[35], qubits[66], qubits[101], qubits[11], qubits[71], qubits[121], qubits[105], qubits[31], qubits[42], qubits[62], qubits[14], qubits[28], qubits[10], qubits[70], qubits[119], qubits[69], qubits[113], qubits[126], qubits[100], qubits[81], qubits[33], qubits[56], qubits[97], qubits[7], qubits[85], qubits[16], qubits[44], qubits[120], qubits[118], qubits[0], qubits[104], qubits[124], qubits[1], qubits[3], qubits[38], qubits[89]]
		# Non-leaf function
		func5 = Func5(37, is_inverse=self.is_inverse)
		func5R = Func5(37, is_inverse=(not self.is_inverse))
		nq0 = [qubits[42], qubits[24], qubits[44], qubits[41], qubits[34], qubits[59], qubits[13], qubits[127], qubits[123], qubits[72], qubits[11], qubits[31], qubits[17], qubits[102], qubits[115], qubits[121], qubits[23], qubits[69], qubits[100], qubits[71], qubits[82], qubits[90], qubits[18], qubits[92], qubits[91], qubits[98], qubits[8], qubits[67], qubits[87], anc[8], anc[9], anc[10], anc[11], anc[12], anc[13], anc[14], anc[15]]
		func6 = Func6(85, is_inverse=self.is_inverse)
		func6R = Func6(85, is_inverse=(not self.is_inverse))
		nq1 = [qubits[51], qubits[36], qubits[126], qubits[105], qubits[122], qubits[35], qubits[77], qubits[37], qubits[47], qubits[57], qubits[54], anc[4], qubits[14], qubits[19], qubits[63], qubits[101], qubits[82], qubits[25], qubits[114], qubits[59], qubits[104], qubits[18], qubits[27], qubits[111], qubits[76], qubits[65], qubits[100], qubits[12], qubits[32], qubits[80], qubits[84], anc[7], qubits[23], qubits[127], qubits[110], qubits[69], anc[1], qubits[17], qubits[91], qubits[88], qubits[124], qubits[79], qubits[121], qubits[90], qubits[81], qubits[112], qubits[87], qubits[5], qubits[113], qubits[60], anc[5], qubits[10], qubits[64], anc[0], qubits[117], qubits[9], qubits[30], anc[6], qubits[49], qubits[109], qubits[92], qubits[33], qubits[53], qubits[20], qubits[26], qubits[58], qubits[3], qubits[120], qubits[78], anc[2], qubits[125], qubits[66], qubits[95], qubits[43], qubits[45], qubits[39], qubits[93], qubits[68], qubits[16], qubits[13], qubits[52], qubits[119], qubits[4], anc[16], anc[17]]
		if not self.is_inverse: 
			# Compute 
			yield cirq.TOFFOLI( qubits[93], qubits[110], qubits[12] )
			yield cirq.TOFFOLI( qubits[67], qubits[90], qubits[91] )
			yield cirq.TOFFOLI( qubits[85], anc[5], qubits[4] )
			yield cirq.CNOT( qubits[127], anc[0] )
			yield cirq.CNOT( qubits[87], qubits[42] )
			yield cirq.TOFFOLI( qubits[104], qubits[88], qubits[68] )
			yield cirq.TOFFOLI( qubits[78], qubits[51], qubits[11] )
			yield cirq.CNOT( qubits[98], qubits[58] )
			yield cirq.CNOT( qubits[67], qubits[115] )
			yield cirq.CNOT( qubits[50], qubits[72] )
			yield cirq.TOFFOLI( qubits[62], qubits[10], qubits[28] )
			yield cirq.CNOT( qubits[32], qubits[35] )
			yield cirq.CNOT( qubits[86], qubits[93] )
			yield cirq.CNOT( anc[5], qubits[94] )
			yield cirq.CNOT( qubits[125], qubits[97] )
			yield cirq.CNOT( qubits[121], anc[5] )
			yield cirq.TOFFOLI( qubits[123], qubits[43], qubits[57] )
			yield cirq.TOFFOLI( qubits[16], qubits[27], qubits[77] )
			yield cirq.CNOT( qubits[3], qubits[26] )
			yield cirq.CNOT( qubits[114], qubits[98] )
			yield cirq.CNOT( qubits[114], qubits[2] )
			yield cirq.CNOT( qubits[127], qubits[42] )
			yield cirq.TOFFOLI( qubits[40], qubits[37], qubits[127] )
			yield cirq.TOFFOLI( qubits[120], qubits[34], qubits[56] )
			yield cirq.CNOT( qubits[64], qubits[119] )
			yield cirq.CNOT( qubits[42], qubits[39] )
			yield cirq.TOFFOLI( anc[6], anc[5], qubits[110] )
			yield cirq.CNOT( qubits[8], qubits[61] )
			yield cirq.TOFFOLI( qubits[103], qubits[28], qubits[37] )
			yield cirq.TOFFOLI( qubits[32], qubits[31], qubits[106] )
			yield cirq.CNOT( qubits[89], qubits[90] )
			yield cirq.TOFFOLI( qubits[110], anc[0], qubits[109] )
			yield cirq.TOFFOLI( qubits[6], qubits[122], qubits[72] )
			yield func6(*nq1)
			yield cirq.CNOT( qubits[16], qubits[65] )
			yield cirq.CNOT( qubits[40], qubits[71] )
			yield cirq.TOFFOLI( qubits[8], qubits[88], qubits[53] )
			yield cirq.TOFFOLI( qubits[78], qubits[97], qubits[0] )
			yield cirq.TOFFOLI( qubits[98], qubits[86], qubits[24] )
			yield cirq.CNOT( qubits[67], anc[4] )
			yield func5(*nq0)
			yield cirq.CNOT( qubits[122], qubits[16] )
			yield cirq.CNOT( qubits[25], qubits[41] )
			yield cirq.CNOT( qubits[103], qubits[8] )
			yield cirq.CNOT( qubits[54], qubits[57] )
			yield cirq.TOFFOLI( qubits[33], qubits[25], qubits[79] )
			yield cirq.TOFFOLI( qubits[94], qubits[7], qubits[93] )
			yield cirq.CNOT( qubits[9], qubits[125] )
			yield cirq.TOFFOLI( qubits[92], qubits[21], qubits[118] )
			yield cirq.TOFFOLI( qubits[72], qubits[30], qubits[59] )
			yield cirq.TOFFOLI( qubits[24], anc[7], qubits[32] )
			yield cirq.CNOT( qubits[2], qubits[27] )
			yield cirq.CNOT( qubits[73], qubits[72] )
			yield cirq.TOFFOLI( qubits[127], qubits[14], qubits[15] )
			yield cirq.TOFFOLI( qubits[107], qubits[108], qubits[106] )
			yield cirq.CNOT( anc[0], qubits[42] )
			yield cirq.TOFFOLI( qubits[76], qubits[79], qubits[44] )
			yield cirq.CNOT( qubits[22], anc[6] )
			yield cirq.TOFFOLI( qubits[74], qubits[18], qubits[10] )
			yield cirq.TOFFOLI( qubits[26], qubits[76], qubits[67] )
			yield cirq.TOFFOLI( qubits[111], qubits[94], qubits[43] )
			yield cirq.CNOT( qubits[112], qubits[118] )
			yield cirq.TOFFOLI( qubits[63], qubits[49], qubits[79] )
			yield cirq.TOFFOLI( qubits[73], qubits[94], qubits[63] )
			yield cirq.TOFFOLI( qubits[20], qubits[103], qubits[9] )
			yield cirq.TOFFOLI( qubits[84], qubits[89], qubits[17] )
			yield cirq.CNOT( qubits[17], qubits[35] )
			yield cirq.TOFFOLI( qubits[81], qubits[48], qubits[89] )
			yield cirq.CNOT( qubits[117], qubits[56] )
			yield cirq.CNOT( qubits[58], qubits[126] )
			yield cirq.CNOT( qubits[76], qubits[118] )
			yield cirq.CNOT( qubits[23], qubits[26] )
			yield cirq.TOFFOLI( qubits[98], qubits[80], qubits[15] )
			yield cirq.CNOT( qubits[61], qubits[49] )
			yield cirq.TOFFOLI( qubits[65], qubits[23], qubits[43] )
			yield cirq.CNOT( qubits[106], qubits[61] )
			yield cirq.TOFFOLI( qubits[1], qubits[43], qubits[37] )
			yield cirq.TOFFOLI( qubits[51], qubits[7], qubits[16] )
			yield cirq.CNOT( anc[1], qubits[86] )
			yield cirq.TOFFOLI( qubits[87], qubits[7], qubits[13] )
			yield cirq.TOFFOLI( qubits[20], qubits[110], qubits[69] )
			yield cirq.CNOT( anc[4], qubits[68] )
			yield cirq.CNOT( qubits[54], qubits[65] )
			yield cirq.CNOT( qubits[40], qubits[58] )
			yield cirq.TOFFOLI( qubits[49], qubits[70], qubits[99] )
			yield cirq.TOFFOLI( qubits[100], qubits[67], qubits[122] )
			yield cirq.CNOT( qubits[102], qubits[40] )
			yield cirq.TOFFOLI( qubits[37], qubits[24], qubits[19] )
			yield cirq.TOFFOLI( qubits[20], qubits[98], qubits[79] )
			yield cirq.CNOT( qubits[48], qubits[77] )
			yield cirq.TOFFOLI( qubits[7], qubits[117], qubits[111] )
			yield cirq.TOFFOLI( qubits[20], qubits[72], qubits[37] )
			yield cirq.TOFFOLI( qubits[20], qubits[52], qubits[28] )
			yield cirq.TOFFOLI( qubits[48], qubits[118], qubits[64] )
			yield cirq.TOFFOLI( qubits[6], qubits[80], qubits[37] )
			yield cirq.TOFFOLI( qubits[93], qubits[100], qubits[111] )
			yield cirq.TOFFOLI( qubits[92], qubits[7], qubits[88] )
			yield cirq.TOFFOLI( qubits[41], qubits[92], qubits[10] )
			yield cirq.TOFFOLI( qubits[109], qubits[56], anc[6] )
			yield cirq.TOFFOLI( qubits[39], qubits[29], qubits[84] )
			yield cirq.CNOT( qubits[91], qubits[99] )
			yield cirq.CNOT( qubits[120], qubits[73] )
			yield cirq.CNOT( qubits[76], qubits[23] )
			yield cirq.CNOT( qubits[87], qubits[30] )
			yield cirq.TOFFOLI( qubits[64], qubits[73], anc[3] )
			yield cirq.TOFFOLI( qubits[3], qubits[119], qubits[69] )
			yield cirq.TOFFOLI( qubits[124], qubits[127], qubits[28] )
			yield cirq.TOFFOLI( qubits[18], qubits[11], qubits[96] )
			yield cirq.CNOT( qubits[99], qubits[24] )
			yield cirq.TOFFOLI( qubits[81], qubits[26], qubits[29] )
			yield cirq.TOFFOLI( qubits[11], qubits[75], qubits[33] )
			yield cirq.TOFFOLI( qubits[90], qubits[56], qubits[111] )
			yield cirq.TOFFOLI( qubits[89], qubits[113], qubits[77] )
			yield cirq.CNOT( qubits[115], qubits[117] )
			yield cirq.TOFFOLI( qubits[25], qubits[52], qubits[96] )
			yield cirq.TOFFOLI( qubits[103], qubits[12], qubits[9] )
			# Store 
			# Note: this version does not store results.
		else: 
			yield cirq.TOFFOLI( qubits[103], qubits[12], qubits[9] )
			yield cirq.TOFFOLI( qubits[25], qubits[52], qubits[96] )
			yield cirq.CNOT( qubits[115], qubits[117] )
			yield cirq.TOFFOLI( qubits[89], qubits[113], qubits[77] )
			yield cirq.TOFFOLI( qubits[90], qubits[56], qubits[111] )
			yield cirq.TOFFOLI( qubits[11], qubits[75], qubits[33] )
			yield cirq.TOFFOLI( qubits[81], qubits[26], qubits[29] )
			yield cirq.CNOT( qubits[99], qubits[24] )
			yield cirq.TOFFOLI( qubits[18], qubits[11], qubits[96] )
			yield cirq.TOFFOLI( qubits[124], qubits[127], qubits[28] )
			yield cirq.TOFFOLI( qubits[3], qubits[119], qubits[69] )
			yield cirq.TOFFOLI( qubits[64], qubits[73], anc[3] )
			yield cirq.CNOT( qubits[87], qubits[30] )
			yield cirq.CNOT( qubits[76], qubits[23] )
			yield cirq.CNOT( qubits[120], qubits[73] )
			yield cirq.CNOT( qubits[91], qubits[99] )
			yield cirq.TOFFOLI( qubits[39], qubits[29], qubits[84] )
			yield cirq.TOFFOLI( qubits[109], qubits[56], anc[6] )
			yield cirq.TOFFOLI( qubits[41], qubits[92], qubits[10] )
			yield cirq.TOFFOLI( qubits[92], qubits[7], qubits[88] )
			yield cirq.TOFFOLI( qubits[93], qubits[100], qubits[111] )
			yield cirq.TOFFOLI( qubits[6], qubits[80], qubits[37] )
			yield cirq.TOFFOLI( qubits[48], qubits[118], qubits[64] )
			yield cirq.TOFFOLI( qubits[20], qubits[52], qubits[28] )
			yield cirq.TOFFOLI( qubits[20], qubits[72], qubits[37] )
			yield cirq.TOFFOLI( qubits[7], qubits[117], qubits[111] )
			yield cirq.CNOT( qubits[48], qubits[77] )
			yield cirq.TOFFOLI( qubits[20], qubits[98], qubits[79] )
			yield cirq.TOFFOLI( qubits[37], qubits[24], qubits[19] )
			yield cirq.CNOT( qubits[102], qubits[40] )
			yield cirq.TOFFOLI( qubits[100], qubits[67], qubits[122] )
			yield cirq.TOFFOLI( qubits[49], qubits[70], qubits[99] )
			yield cirq.CNOT( qubits[40], qubits[58] )
			yield cirq.CNOT( qubits[54], qubits[65] )
			yield cirq.CNOT( anc[4], qubits[68] )
			yield cirq.TOFFOLI( qubits[20], qubits[110], qubits[69] )
			yield cirq.TOFFOLI( qubits[87], qubits[7], qubits[13] )
			yield cirq.CNOT( anc[1], qubits[86] )
			yield cirq.TOFFOLI( qubits[51], qubits[7], qubits[16] )
			yield cirq.TOFFOLI( qubits[1], qubits[43], qubits[37] )
			yield cirq.CNOT( qubits[106], qubits[61] )
			yield cirq.TOFFOLI( qubits[65], qubits[23], qubits[43] )
			yield cirq.CNOT( qubits[61], qubits[49] )
			yield cirq.TOFFOLI( qubits[98], qubits[80], qubits[15] )
			yield cirq.CNOT( qubits[23], qubits[26] )
			yield cirq.CNOT( qubits[76], qubits[118] )
			yield cirq.CNOT( qubits[58], qubits[126] )
			yield cirq.CNOT( qubits[117], qubits[56] )
			yield cirq.TOFFOLI( qubits[81], qubits[48], qubits[89] )
			yield cirq.CNOT( qubits[17], qubits[35] )
			yield cirq.TOFFOLI( qubits[84], qubits[89], qubits[17] )
			yield cirq.TOFFOLI( qubits[20], qubits[103], qubits[9] )
			yield cirq.TOFFOLI( qubits[73], qubits[94], qubits[63] )
			yield cirq.TOFFOLI( qubits[63], qubits[49], qubits[79] )
			yield cirq.CNOT( qubits[112], qubits[118] )
			yield cirq.TOFFOLI( qubits[111], qubits[94], qubits[43] )
			yield cirq.TOFFOLI( qubits[26], qubits[76], qubits[67] )
			yield cirq.TOFFOLI( qubits[74], qubits[18], qubits[10] )
			yield cirq.CNOT( qubits[22], anc[6] )
			yield cirq.TOFFOLI( qubits[76], qubits[79], qubits[44] )
			yield cirq.CNOT( anc[0], qubits[42] )
			yield cirq.TOFFOLI( qubits[107], qubits[108], qubits[106] )
			yield cirq.TOFFOLI( qubits[127], qubits[14], qubits[15] )
			yield cirq.CNOT( qubits[73], qubits[72] )
			yield cirq.CNOT( qubits[2], qubits[27] )
			yield cirq.TOFFOLI( qubits[24], anc[7], qubits[32] )
			yield cirq.TOFFOLI( qubits[72], qubits[30], qubits[59] )
			yield cirq.TOFFOLI( qubits[92], qubits[21], qubits[118] )
			yield cirq.CNOT( qubits[9], qubits[125] )
			yield cirq.TOFFOLI( qubits[94], qubits[7], qubits[93] )
			yield cirq.TOFFOLI( qubits[33], qubits[25], qubits[79] )
			yield cirq.CNOT( qubits[54], qubits[57] )
			yield cirq.CNOT( qubits[103], qubits[8] )
			yield cirq.CNOT( qubits[25], qubits[41] )
			yield cirq.CNOT( qubits[122], qubits[16] )
			yield func5R(*nq0)
			yield cirq.CNOT( qubits[67], anc[4] )
			yield cirq.TOFFOLI( qubits[98], qubits[86], qubits[24] )
			yield cirq.TOFFOLI( qubits[78], qubits[97], qubits[0] )
			yield cirq.TOFFOLI( qubits[8], qubits[88], qubits[53] )
			yield cirq.CNOT( qubits[40], qubits[71] )
			yield cirq.CNOT( qubits[16], qubits[65] )
			yield func6R(*nq1)
			yield cirq.TOFFOLI( qubits[6], qubits[122], qubits[72] )
			yield cirq.TOFFOLI( qubits[110], anc[0], qubits[109] )
			yield cirq.CNOT( qubits[89], qubits[90] )
			yield cirq.TOFFOLI( qubits[32], qubits[31], qubits[106] )
			yield cirq.TOFFOLI( qubits[103], qubits[28], qubits[37] )
			yield cirq.CNOT( qubits[8], qubits[61] )
			yield cirq.TOFFOLI( anc[6], anc[5], qubits[110] )
			yield cirq.CNOT( qubits[42], qubits[39] )
			yield cirq.CNOT( qubits[64], qubits[119] )
			yield cirq.TOFFOLI( qubits[120], qubits[34], qubits[56] )
			yield cirq.TOFFOLI( qubits[40], qubits[37], qubits[127] )
			yield cirq.CNOT( qubits[127], qubits[42] )
			yield cirq.CNOT( qubits[114], qubits[2] )
			yield cirq.CNOT( qubits[114], qubits[98] )
			yield cirq.CNOT( qubits[3], qubits[26] )
			yield cirq.TOFFOLI( qubits[16], qubits[27], qubits[77] )
			yield cirq.TOFFOLI( qubits[123], qubits[43], qubits[57] )
			yield cirq.CNOT( qubits[121], anc[5] )
			yield cirq.CNOT( qubits[125], qubits[97] )
			yield cirq.CNOT( anc[5], qubits[94] )
			yield cirq.CNOT( qubits[86], qubits[93] )
			yield cirq.CNOT( qubits[32], qubits[35] )
			yield cirq.TOFFOLI( qubits[62], qubits[10], qubits[28] )
			yield cirq.CNOT( qubits[50], qubits[72] )
			yield cirq.CNOT( qubits[67], qubits[115] )
			yield cirq.CNOT( qubits[98], qubits[58] )
			yield cirq.TOFFOLI( qubits[78], qubits[51], qubits[11] )
			yield cirq.TOFFOLI( qubits[104], qubits[88], qubits[68] )
			yield cirq.CNOT( qubits[87], qubits[42] )
			yield cirq.CNOT( qubits[127], anc[0] )
			yield cirq.TOFFOLI( qubits[85], anc[5], qubits[4] )
			yield cirq.TOFFOLI( qubits[67], qubits[90], qubits[91] )
			yield cirq.TOFFOLI( qubits[93], qubits[110], qubits[12] )
# Function 1 with degree 3
# nq: 128, na: 8, ng: 256
class Func1(cirq.Gate):
	def __init__(self, num_qubits, is_inverse=False):
		self._num_qubits = num_qubits
		self.is_inverse = is_inverse
	def num_qubits(self):
		return self._num_qubits
	def __pow__(self, power):
		if power == -1:
			return Func1(self._num_qubits, is_inverse=True)
		else:
			return NotImplemented
	def _decompose_(self, qubits):
		anc = qubits[128:] # ancilla
		res = [qubits[64], qubits[56], qubits[115], qubits[123], qubits[108], qubits[111], qubits[33], qubits[2], qubits[28], qubits[74], qubits[52], qubits[27], qubits[73], qubits[78], qubits[58], qubits[93], qubits[69], qubits[18], qubits[45], qubits[87], qubits[125], qubits[26], qubits[107], qubits[46], qubits[114], qubits[113], qubits[62]]
		# Non-leaf function
		func2 = Func2(146, is_inverse=self.is_inverse)
		func2R = Func2(146, is_inverse=(not self.is_inverse))
		nq0 = [qubits[28], qubits[2], qubits[52], qubits[77], qubits[1], anc[4], qubits[121], qubits[34], qubits[127], qubits[124], qubits[61], qubits[4], qubits[31], qubits[116], qubits[73], qubits[117], qubits[94], qubits[87], qubits[5], qubits[123], qubits[10], qubits[70], qubits[107], qubits[106], qubits[44], qubits[0], qubits[84], qubits[122], qubits[22], qubits[80], qubits[42], qubits[41], qubits[65], qubits[113], qubits[40], qubits[93], qubits[15], qubits[59], qubits[20], qubits[16], qubits[69], qubits[92], qubits[33], qubits[97], qubits[21], qubits[89], qubits[125], qubits[43], qubits[27], qubits[53], qubits[108], qubits[23], qubits[18], qubits[72], qubits[126], qubits[48], anc[6], anc[1], qubits[82], qubits[67], qubits[74], qubits[81], qubits[29], qubits[54], qubits[66], qubits[109], qubits[119], qubits[101], qubits[114], qubits[57], qubits[64], qubits[91], qubits[50], qubits[96], qubits[26], anc[5], qubits[6], qubits[62], qubits[105], qubits[68], qubits[102], anc[3], qubits[104], qubits[19], qubits[95], qubits[32], qubits[17], qubits[99], qubits[83], qubits[37], qubits[78], qubits[39], qubits[45], qubits[25], qubits[24], qubits[86], qubits[7], qubits[9], qubits[88], qubits[110], qubits[56], qubits[76], qubits[49], qubits[103], qubits[8], qubits[90], qubits[3], qubits[47], qubits[85], anc[0], qubits[51], qubits[11], anc[7], qubits[79], qubits[13], qubits[63], qubits[120], qubits[98], qubits[100], qubits[71], qubits[36], qubits[75], qubits[115], qubits[35], qubits[60], qubits[58], qubits[111], qubits[46], anc[8], anc[9], anc[10], anc[11], anc[12], anc[13], anc[14], anc[15], anc[16], anc[17], anc[18], anc[19], anc[20], anc[21], anc[22], anc[23], anc[24], anc[25]]
		func3 = Func3(126, is_inverse=self.is_inverse)
		func3R = Func3(126, is_inverse=(not self.is_inverse))
		nq1 = [qubits[65], qubits[33], qubits[101], qubits[8], qubits[117], qubits[91], qubits[104], qubits[84], qubits[51], qubits[111], qubits[113], qubits[95], qubits[120], qubits[93], qubits[59], qubits[110], qubits[79], qubits[108], qubits[105], qubits[112], qubits[103], qubits[115], qubits[76], qubits[119], qubits[11], qubits[54], anc[5], qubits[22], qubits[12], qubits[107], qubits[6], qubits[118], qubits[30], qubits[37], qubits[96], qubits[85], qubits[61], qubits[7], qubits[109], qubits[16], qubits[17], qubits[40], qubits[27], anc[4], qubits[74], qubits[62], qubits[3], anc[6], qubits[49], qubits[18], qubits[50], qubits[36], qubits[39], qubits[1], qubits[73], qubits[19], qubits[99], qubits[83], qubits[126], anc[0], qubits[21], qubits[58], qubits[43], qubits[57], qubits[42], qubits[122], qubits[29], qubits[88], qubits[116], qubits[98], qubits[97], qubits[9], qubits[121], qubits[44], qubits[71], qubits[102], qubits[41], qubits[48], qubits[75], qubits[72], qubits[45], qubits[80], qubits[77], anc[7], qubits[82], qubits[87], qubits[127], qubits[68], qubits[4], anc[1], qubits[78], qubits[34], qubits[25], qubits[15], qubits[69], qubits[86], qubits[60], qubits[125], qubits[123], qubits[70], qubits[32], qubits[26], qubits[46], qubits[31], qubits[66], qubits[124], qubits[56], qubits[94], qubits[28], qubits[81], qubits[14], qubits[23], qubits[13], qubits[20], qubits[63], qubits[38], qubits[35], qubits[55], qubits[5], qubits[10], anc[26], anc[27], anc[28], anc[29], anc[30], anc[31]]
		func4 = Func4(112, is_inverse=self.is_inverse)
		func4R = Func4(112, is_inverse=(not self.is_inverse))
		nq2 = [qubits[12], qubits[61], qubits[92], qubits[78], qubits[69], qubits[47], qubits[111], qubits[110], qubits[83], qubits[96], qubits[6], qubits[74], qubits[9], qubits[120], qubits[99], qubits[55], qubits[98], qubits[60], qubits[16], qubits[122], qubits[126], qubits[35], anc[1], qubits[118], qubits[42], qubits[58], qubits[8], qubits[84], qubits[115], qubits[80], qubits[45], anc[0], qubits[75], qubits[90], qubits[20], qubits[59], qubits[87], qubits[127], qubits[38], qubits[5], qubits[52], qubits[39], qubits[86], qubits[4], qubits[21], qubits[24], anc[7], qubits[10], qubits[89], qubits[0], qubits[123], qubits[106], qubits[65], qubits[31], anc[4], qubits[108], qubits[116], qubits[54], qubits[37], qubits[40], qubits[17], anc[6], qubits[70], qubits[25], qubits[73], qubits[76], qubits[23], qubits[63], qubits[113], qubits[49], qubits[50], qubits[81], qubits[18], qubits[91], qubits[46], qubits[109], qubits[43], qubits[117], qubits[97], qubits[107], qubits[33], qubits[104], qubits[32], qubits[121], qubits[30], qubits[102], qubits[125], qubits[27], qubits[71], qubits[79], anc[5], qubits[68], qubits[119], qubits[77], qubits[95], qubits[19], qubits[100], qubits[93], qubits[2], qubits[53], qubits[66], qubits[88], qubits[26], qubits[112], qubits[28], qubits[34], qubits[101], qubits[57], qubits[1], qubits[85], anc[32], anc[33]]
		if not self.is_inverse: 
			# Compute 
			yield cirq.CNOT( qubits[75], qubits[98] )
			yield cirq.TOFFOLI( qubits[19], qubits[18], qubits[110] )
			yield cirq.TOFFOLI( qubits[2], qubits[18], qubits[42] )
			yield cirq.TOFFOLI( qubits[99], qubits[65], qubits[75] )
			yield cirq.CNOT( qubits[30], qubits[124] )
			yield cirq.TOFFOLI( qubits[83], qubits[123], qubits[59] )
			yield cirq.CNOT( qubits[33], qubits[107] )
			yield cirq.CNOT( qubits[125], qubits[13] )
			yield cirq.CNOT( qubits[68], qubits[28] )
			yield cirq.CNOT( qubits[108], qubits[17] )
			yield cirq.CNOT( qubits[98], qubits[43] )
			yield cirq.CNOT( qubits[57], qubits[26] )
			yield cirq.CNOT( qubits[117], qubits[4] )
			yield cirq.CNOT( qubits[98], qubits[118] )
			yield cirq.TOFFOLI( qubits[43], qubits[70], qubits[65] )
			yield cirq.TOFFOLI( qubits[116], qubits[60], qubits[65] )
			yield cirq.CNOT( qubits[50], qubits[98] )
			yield cirq.CNOT( qubits[121], qubits[39] )
			yield cirq.TOFFOLI( qubits[77], qubits[30], qubits[27] )
			yield cirq.TOFFOLI( qubits[24], qubits[44], qubits[76] )
			yield cirq.TOFFOLI( qubits[10], qubits[13], qubits[27] )
			yield cirq.TOFFOLI( qubits[82], qubits[113], qubits[66] )
			yield cirq.CNOT( qubits[9], qubits[85] )
			yield cirq.CNOT( qubits[50], qubits[14] )
			yield cirq.CNOT( qubits[0], qubits[102] )
			yield cirq.CNOT( qubits[76], qubits[10] )
			yield cirq.TOFFOLI( qubits[61], qubits[36], qubits[124] )
			yield cirq.TOFFOLI( qubits[19], qubits[49], anc[4] )
			yield cirq.CNOT( qubits[7], qubits[78] )
			yield cirq.CNOT( qubits[75], qubits[78] )
			yield cirq.TOFFOLI( qubits[16], qubits[117], qubits[10] )
			yield cirq.TOFFOLI( qubits[68], qubits[95], qubits[112] )
			yield cirq.TOFFOLI( qubits[84], qubits[0], qubits[81] )
			yield cirq.CNOT( qubits[29], qubits[25] )
			yield cirq.CNOT( qubits[7], qubits[67] )
			yield cirq.TOFFOLI( qubits[80], qubits[85], qubits[83] )
			yield func2(*nq0)
			yield cirq.CNOT( qubits[113], qubits[35] )
			yield cirq.TOFFOLI( qubits[4], qubits[111], qubits[12] )
			yield cirq.TOFFOLI( qubits[109], qubits[43], qubits[73] )
			yield cirq.TOFFOLI( qubits[18], qubits[27], qubits[109] )
			yield cirq.CNOT( qubits[9], qubits[125] )
			yield cirq.CNOT( qubits[2], qubits[104] )
			yield cirq.TOFFOLI( qubits[14], qubits[44], qubits[8] )
			yield cirq.TOFFOLI( qubits[65], qubits[104], qubits[46] )
			yield cirq.TOFFOLI( qubits[53], qubits[8], qubits[60] )
			yield cirq.TOFFOLI( qubits[67], qubits[8], qubits[71] )
			yield cirq.CNOT( qubits[117], qubits[84] )
			yield cirq.CNOT( qubits[25], qubits[49] )
			yield cirq.TOFFOLI( qubits[39], qubits[74], qubits[44] )
			yield cirq.TOFFOLI( qubits[107], qubits[99], qubits[85] )
			yield cirq.TOFFOLI( qubits[73], qubits[109], qubits[54] )
			yield cirq.TOFFOLI( qubits[9], qubits[5], qubits[120] )
			yield cirq.TOFFOLI( anc[2], qubits[115], qubits[11] )
			yield cirq.TOFFOLI( qubits[4], qubits[106], qubits[41] )
			yield cirq.CNOT( qubits[53], qubits[62] )
			yield cirq.CNOT( qubits[117], qubits[39] )
			yield cirq.TOFFOLI( qubits[28], qubits[38], qubits[20] )
			yield cirq.CNOT( qubits[41], qubits[123] )
			yield cirq.CNOT( qubits[6], qubits[122] )
			yield cirq.TOFFOLI( qubits[19], qubits[65], qubits[60] )
			yield cirq.TOFFOLI( qubits[42], qubits[68], qubits[91] )
			yield cirq.CNOT( qubits[64], qubits[50] )
			yield cirq.CNOT( qubits[38], qubits[24] )
			yield cirq.TOFFOLI( qubits[20], qubits[17], qubits[124] )
			yield cirq.CNOT( qubits[119], qubits[82] )
			yield cirq.TOFFOLI( qubits[23], qubits[63], qubits[114] )
			yield cirq.TOFFOLI( qubits[75], qubits[78], qubits[14] )
			yield cirq.CNOT( qubits[92], qubits[18] )
			yield cirq.TOFFOLI( qubits[67], anc[2], qubits[74] )
			yield cirq.TOFFOLI( qubits[89], qubits[5], qubits[110] )
			yield cirq.CNOT( qubits[58], qubits[123] )
			yield cirq.CNOT( anc[2], qubits[114] )
			yield cirq.TOFFOLI( anc[3], qubits[106], qubits[65] )
			yield cirq.TOFFOLI( qubits[58], qubits[35], qubits[43] )
			yield cirq.TOFFOLI( qubits[111], qubits[115], qubits[18] )
			yield cirq.CNOT( qubits[73], qubits[65] )
			yield cirq.CNOT( qubits[127], qubits[38] )
			yield cirq.CNOT( qubits[119], qubits[70] )
			yield cirq.TOFFOLI( qubits[117], qubits[32], qubits[81] )
			yield cirq.CNOT( qubits[87], qubits[116] )
			yield cirq.CNOT( qubits[8], qubits[68] )
			yield cirq.TOFFOLI( anc[7], qubits[31], anc[4] )
			yield func3(*nq1)
			yield cirq.TOFFOLI( qubits[84], qubits[101], anc[4] )
			yield cirq.CNOT( qubits[73], qubits[69] )
			yield cirq.CNOT( qubits[68], qubits[30] )
			yield cirq.CNOT( qubits[7], anc[5] )
			yield cirq.TOFFOLI( qubits[75], qubits[91], qubits[69] )
			yield cirq.TOFFOLI( anc[4], qubits[95], qubits[110] )
			yield cirq.CNOT( qubits[23], qubits[29] )
			yield cirq.TOFFOLI( qubits[81], qubits[123], qubits[69] )
			yield cirq.CNOT( qubits[0], qubits[16] )
			yield cirq.CNOT( qubits[94], qubits[23] )
			yield cirq.TOFFOLI( qubits[113], qubits[77], qubits[84] )
			yield cirq.CNOT( qubits[93], qubits[23] )
			yield cirq.TOFFOLI( qubits[26], qubits[80], qubits[40] )
			yield cirq.TOFFOLI( qubits[38], qubits[110], qubits[96] )
			yield cirq.TOFFOLI( anc[7], qubits[104], qubits[94] )
			yield cirq.CNOT( qubits[74], qubits[106] )
			yield cirq.TOFFOLI( anc[2], qubits[74], qubits[107] )
			yield cirq.CNOT( qubits[6], qubits[122] )
			yield cirq.TOFFOLI( qubits[32], qubits[63], qubits[74] )
			yield cirq.TOFFOLI( qubits[25], qubits[79], qubits[16] )
			yield cirq.TOFFOLI( qubits[61], qubits[14], qubits[115] )
			yield cirq.TOFFOLI( qubits[48], qubits[13], qubits[9] )
			yield cirq.CNOT( qubits[37], qubits[72] )
			yield cirq.CNOT( qubits[87], qubits[102] )
			yield cirq.CNOT( qubits[127], qubits[8] )
			yield cirq.TOFFOLI( qubits[31], anc[0], qubits[122] )
			yield cirq.CNOT( anc[7], qubits[18] )
			yield cirq.TOFFOLI( qubits[28], qubits[101], qubits[105] )
			yield cirq.TOFFOLI( qubits[57], qubits[39], qubits[112] )
			yield cirq.CNOT( qubits[83], qubits[39] )
			yield cirq.TOFFOLI( qubits[6], qubits[76], qubits[104] )
			yield cirq.TOFFOLI( qubits[22], qubits[115], qubits[28] )
			yield cirq.TOFFOLI( qubits[67], qubits[24], qubits[126] )
			yield cirq.CNOT( qubits[12], qubits[108] )
			yield cirq.TOFFOLI( qubits[23], qubits[64], qubits[93] )
			yield cirq.CNOT( qubits[52], qubits[100] )
			yield cirq.TOFFOLI( qubits[103], qubits[119], qubits[5] )
			yield cirq.CNOT( qubits[57], qubits[63] )
			yield cirq.CNOT( qubits[36], qubits[38] )
			yield cirq.CNOT( qubits[55], qubits[10] )
			yield cirq.TOFFOLI( qubits[16], qubits[65], qubits[118] )
			yield cirq.CNOT( qubits[74], qubits[71] )
			yield cirq.TOFFOLI( qubits[0], qubits[16], qubits[62] )
			yield cirq.TOFFOLI( qubits[24], qubits[127], qubits[62] )
			yield cirq.CNOT( qubits[77], qubits[80] )
			yield cirq.TOFFOLI( qubits[33], qubits[70], anc[2] )
			yield cirq.CNOT( qubits[98], qubits[112] )
			yield cirq.CNOT( qubits[46], qubits[0] )
			yield cirq.TOFFOLI( qubits[36], qubits[107], anc[2] )
			yield cirq.TOFFOLI( qubits[40], qubits[28], qubits[61] )
			yield cirq.TOFFOLI( qubits[22], qubits[121], qubits[2] )
			yield cirq.CNOT( qubits[106], qubits[44] )
			yield cirq.CNOT( qubits[18], qubits[32] )
			yield cirq.CNOT( qubits[97], qubits[99] )
			yield cirq.CNOT( qubits[74], qubits[10] )
			yield cirq.TOFFOLI( anc[5], qubits[119], qubits[21] )
			yield cirq.CNOT( qubits[63], qubits[16] )
			yield cirq.CNOT( qubits[100], qubits[51] )
			yield cirq.TOFFOLI( qubits[64], qubits[86], qubits[120] )
			yield cirq.CNOT( qubits[112], qubits[53] )
			yield cirq.CNOT( qubits[2], qubits[109] )
			yield cirq.CNOT( qubits[24], qubits[54] )
			yield cirq.CNOT( qubits[96], qubits[0] )
			yield cirq.CNOT( qubits[71], qubits[72] )
			yield cirq.CNOT( qubits[72], qubits[60] )
			yield cirq.TOFFOLI( qubits[84], qubits[23], qubits[94] )
			yield cirq.CNOT( qubits[85], qubits[62] )
			yield cirq.TOFFOLI( qubits[104], qubits[111], qubits[119] )
			yield cirq.CNOT( qubits[78], qubits[99] )
			yield cirq.TOFFOLI( qubits[81], qubits[71], qubits[94] )
			yield cirq.CNOT( qubits[45], qubits[96] )
			yield cirq.CNOT( qubits[57], qubits[127] )
			yield cirq.CNOT( qubits[27], qubits[62] )
			yield cirq.TOFFOLI( qubits[65], qubits[118], qubits[57] )
			yield cirq.TOFFOLI( qubits[124], qubits[30], qubits[58] )
			yield cirq.TOFFOLI( qubits[101], qubits[90], qubits[74] )
			yield cirq.CNOT( qubits[112], qubits[113] )
			yield cirq.TOFFOLI( qubits[19], qubits[51], qubits[127] )
			yield cirq.TOFFOLI( qubits[106], qubits[90], qubits[46] )
			yield cirq.CNOT( qubits[106], qubits[22] )
			yield cirq.CNOT( qubits[63], qubits[115] )
			yield cirq.TOFFOLI( qubits[89], qubits[41], qubits[9] )
			yield cirq.CNOT( anc[6], anc[1] )
			yield cirq.TOFFOLI( qubits[20], qubits[71], qubits[73] )
			yield cirq.TOFFOLI( qubits[115], qubits[105], qubits[85] )
			yield cirq.CNOT( qubits[13], qubits[109] )
			yield cirq.CNOT( qubits[96], qubits[102] )
			yield cirq.TOFFOLI( anc[2], qubits[40], qubits[86] )
			yield cirq.TOFFOLI( qubits[79], qubits[26], qubits[21] )
			yield cirq.CNOT( qubits[77], qubits[120] )
			yield cirq.CNOT( qubits[67], qubits[1] )
			yield cirq.TOFFOLI( qubits[55], qubits[102], qubits[32] )
			yield cirq.CNOT( qubits[12], qubits[123] )
			yield cirq.TOFFOLI( qubits[95], qubits[125], qubits[105] )
			yield cirq.CNOT( qubits[77], qubits[43] )
			yield cirq.CNOT( qubits[18], qubits[105] )
			yield cirq.CNOT( qubits[95], qubits[3] )
			yield cirq.TOFFOLI( qubits[18], qubits[72], qubits[49] )
			yield cirq.TOFFOLI( qubits[23], qubits[119], qubits[39] )
			yield cirq.CNOT( qubits[32], qubits[101] )
			yield cirq.TOFFOLI( qubits[17], qubits[116], qubits[124] )
			yield cirq.TOFFOLI( qubits[88], qubits[123], anc[6] )
			yield cirq.TOFFOLI( qubits[126], qubits[3], qubits[4] )
			yield cirq.CNOT( qubits[17], qubits[103] )
			yield cirq.CNOT( qubits[94], qubits[4] )
			yield cirq.TOFFOLI( qubits[96], qubits[1], qubits[90] )
			yield cirq.CNOT( qubits[4], qubits[119] )
			yield cirq.CNOT( qubits[125], qubits[73] )
			yield cirq.CNOT( qubits[65], qubits[76] )
			yield cirq.CNOT( qubits[14], qubits[124] )
			yield cirq.TOFFOLI( qubits[53], qubits[34], qubits[118] )
			yield cirq.CNOT( qubits[125], qubits[39] )
			yield cirq.CNOT( anc[6], qubits[78] )
			yield cirq.CNOT( qubits[124], qubits[61] )
			yield cirq.CNOT( qubits[23], qubits[108] )
			yield cirq.CNOT( anc[4], qubits[15] )
			yield cirq.TOFFOLI( qubits[115], qubits[33], qubits[90] )
			yield cirq.TOFFOLI( qubits[80], qubits[28], anc[7] )
			yield cirq.TOFFOLI( qubits[102], qubits[15], qubits[26] )
			yield cirq.TOFFOLI( qubits[108], qubits[92], qubits[86] )
			yield cirq.TOFFOLI( qubits[67], qubits[17], qubits[14] )
			yield cirq.CNOT( qubits[70], qubits[63] )
			yield cirq.TOFFOLI( qubits[28], qubits[88], qubits[46] )
			yield cirq.TOFFOLI( qubits[36], qubits[58], qubits[55] )
			yield cirq.TOFFOLI( anc[3], qubits[38], qubits[88] )
			yield cirq.TOFFOLI( qubits[3], qubits[41], qubits[52] )
			yield func4(*nq2)
			yield cirq.CNOT( qubits[87], qubits[122] )
			yield cirq.TOFFOLI( qubits[60], qubits[123], qubits[32] )
			yield cirq.CNOT( qubits[107], qubits[5] )
			yield cirq.TOFFOLI( qubits[0], qubits[127], qubits[9] )
			yield cirq.TOFFOLI( anc[7], qubits[120], qubits[106] )
			yield cirq.TOFFOLI( qubits[31], qubits[78], qubits[7] )
			yield cirq.TOFFOLI( qubits[72], anc[6], qubits[21] )
			yield cirq.CNOT( qubits[118], qubits[35] )
			yield cirq.TOFFOLI( qubits[84], qubits[70], qubits[76] )
			yield cirq.TOFFOLI( qubits[98], anc[0], qubits[114] )
			yield cirq.CNOT( qubits[118], qubits[10] )
			yield cirq.CNOT( anc[6], qubits[0] )
			yield cirq.CNOT( qubits[35], qubits[88] )
			yield cirq.TOFFOLI( qubits[48], qubits[114], qubits[45] )
			yield cirq.TOFFOLI( qubits[113], qubits[16], qubits[106] )
			yield cirq.CNOT( qubits[18], qubits[12] )
			yield cirq.CNOT( qubits[36], qubits[78] )
			yield cirq.CNOT( qubits[76], qubits[86] )
			yield cirq.TOFFOLI( qubits[21], qubits[120], qubits[86] )
			yield cirq.TOFFOLI( qubits[115], qubits[97], qubits[10] )
			yield cirq.TOFFOLI( anc[7], qubits[53], qubits[97] )
			yield cirq.CNOT( qubits[32], qubits[96] )
			yield cirq.CNOT( qubits[49], qubits[65] )
			yield cirq.TOFFOLI( qubits[58], qubits[113], qubits[6] )
			yield cirq.CNOT( qubits[115], qubits[10] )
			yield cirq.CNOT( qubits[87], anc[0] )
			yield cirq.CNOT( qubits[36], qubits[61] )
			yield cirq.TOFFOLI( qubits[102], qubits[104], qubits[30] )
			yield cirq.CNOT( qubits[82], qubits[79] )
			yield cirq.CNOT( qubits[28], qubits[95] )
			yield cirq.TOFFOLI( qubits[63], qubits[119], qubits[104] )
			yield cirq.TOFFOLI( qubits[10], qubits[85], qubits[30] )
			yield cirq.TOFFOLI( qubits[76], qubits[112], qubits[80] )
			yield cirq.TOFFOLI( anc[6], qubits[85], qubits[21] )
			yield cirq.TOFFOLI( qubits[54], qubits[10], qubits[8] )
			yield cirq.TOFFOLI( qubits[34], qubits[124], qubits[58] )
			yield cirq.CNOT( qubits[35], qubits[14] )
			yield cirq.CNOT( qubits[78], qubits[121] )
			yield cirq.TOFFOLI( qubits[127], qubits[61], qubits[0] )
			yield cirq.CNOT( qubits[12], qubits[46] )
			yield cirq.TOFFOLI( qubits[28], qubits[118], qubits[65] )
			yield cirq.TOFFOLI( qubits[45], qubits[73], qubits[26] )
			yield cirq.TOFFOLI( qubits[84], qubits[94], qubits[65] )
			yield cirq.CNOT( qubits[68], qubits[73] )
			yield cirq.CNOT( anc[7], qubits[74] )
			yield cirq.TOFFOLI( qubits[106], qubits[42], qubits[52] )
			yield cirq.CNOT( qubits[17], qubits[89] )
			yield cirq.TOFFOLI( qubits[9], qubits[40], qubits[37] )
			# Store 
			# Note: this version does not store results.
		else: 
			yield cirq.TOFFOLI( qubits[9], qubits[40], qubits[37] )
			yield cirq.CNOT( qubits[17], qubits[89] )
			yield cirq.TOFFOLI( qubits[106], qubits[42], qubits[52] )
			yield cirq.CNOT( anc[7], qubits[74] )
			yield cirq.CNOT( qubits[68], qubits[73] )
			yield cirq.TOFFOLI( qubits[84], qubits[94], qubits[65] )
			yield cirq.TOFFOLI( qubits[45], qubits[73], qubits[26] )
			yield cirq.TOFFOLI( qubits[28], qubits[118], qubits[65] )
			yield cirq.CNOT( qubits[12], qubits[46] )
			yield cirq.TOFFOLI( qubits[127], qubits[61], qubits[0] )
			yield cirq.CNOT( qubits[78], qubits[121] )
			yield cirq.CNOT( qubits[35], qubits[14] )
			yield cirq.TOFFOLI( qubits[34], qubits[124], qubits[58] )
			yield cirq.TOFFOLI( qubits[54], qubits[10], qubits[8] )
			yield cirq.TOFFOLI( anc[6], qubits[85], qubits[21] )
			yield cirq.TOFFOLI( qubits[76], qubits[112], qubits[80] )
			yield cirq.TOFFOLI( qubits[10], qubits[85], qubits[30] )
			yield cirq.TOFFOLI( qubits[63], qubits[119], qubits[104] )
			yield cirq.CNOT( qubits[28], qubits[95] )
			yield cirq.CNOT( qubits[82], qubits[79] )
			yield cirq.TOFFOLI( qubits[102], qubits[104], qubits[30] )
			yield cirq.CNOT( qubits[36], qubits[61] )
			yield cirq.CNOT( qubits[87], anc[0] )
			yield cirq.CNOT( qubits[115], qubits[10] )
			yield cirq.TOFFOLI( qubits[58], qubits[113], qubits[6] )
			yield cirq.CNOT( qubits[49], qubits[65] )
			yield cirq.CNOT( qubits[32], qubits[96] )
			yield cirq.TOFFOLI( anc[7], qubits[53], qubits[97] )
			yield cirq.TOFFOLI( qubits[115], qubits[97], qubits[10] )
			yield cirq.TOFFOLI( qubits[21], qubits[120], qubits[86] )
			yield cirq.CNOT( qubits[76], qubits[86] )
			yield cirq.CNOT( qubits[36], qubits[78] )
			yield cirq.CNOT( qubits[18], qubits[12] )
			yield cirq.TOFFOLI( qubits[113], qubits[16], qubits[106] )
			yield cirq.TOFFOLI( qubits[48], qubits[114], qubits[45] )
			yield cirq.CNOT( qubits[35], qubits[88] )
			yield cirq.CNOT( anc[6], qubits[0] )
			yield cirq.CNOT( qubits[118], qubits[10] )
			yield cirq.TOFFOLI( qubits[98], anc[0], qubits[114] )
			yield cirq.TOFFOLI( qubits[84], qubits[70], qubits[76] )
			yield cirq.CNOT( qubits[118], qubits[35] )
			yield cirq.TOFFOLI( qubits[72], anc[6], qubits[21] )
			yield cirq.TOFFOLI( qubits[31], qubits[78], qubits[7] )
			yield cirq.TOFFOLI( anc[7], qubits[120], qubits[106] )
			yield cirq.TOFFOLI( qubits[0], qubits[127], qubits[9] )
			yield cirq.CNOT( qubits[107], qubits[5] )
			yield cirq.TOFFOLI( qubits[60], qubits[123], qubits[32] )
			yield cirq.CNOT( qubits[87], qubits[122] )
			yield func4R(*nq2)
			yield cirq.TOFFOLI( qubits[3], qubits[41], qubits[52] )
			yield cirq.TOFFOLI( anc[3], qubits[38], qubits[88] )
			yield cirq.TOFFOLI( qubits[36], qubits[58], qubits[55] )
			yield cirq.TOFFOLI( qubits[28], qubits[88], qubits[46] )
			yield cirq.CNOT( qubits[70], qubits[63] )
			yield cirq.TOFFOLI( qubits[67], qubits[17], qubits[14] )
			yield cirq.TOFFOLI( qubits[108], qubits[92], qubits[86] )
			yield cirq.TOFFOLI( qubits[102], qubits[15], qubits[26] )
			yield cirq.TOFFOLI( qubits[80], qubits[28], anc[7] )
			yield cirq.TOFFOLI( qubits[115], qubits[33], qubits[90] )
			yield cirq.CNOT( anc[4], qubits[15] )
			yield cirq.CNOT( qubits[23], qubits[108] )
			yield cirq.CNOT( qubits[124], qubits[61] )
			yield cirq.CNOT( anc[6], qubits[78] )
			yield cirq.CNOT( qubits[125], qubits[39] )
			yield cirq.TOFFOLI( qubits[53], qubits[34], qubits[118] )
			yield cirq.CNOT( qubits[14], qubits[124] )
			yield cirq.CNOT( qubits[65], qubits[76] )
			yield cirq.CNOT( qubits[125], qubits[73] )
			yield cirq.CNOT( qubits[4], qubits[119] )
			yield cirq.TOFFOLI( qubits[96], qubits[1], qubits[90] )
			yield cirq.CNOT( qubits[94], qubits[4] )
			yield cirq.CNOT( qubits[17], qubits[103] )
			yield cirq.TOFFOLI( qubits[126], qubits[3], qubits[4] )
			yield cirq.TOFFOLI( qubits[88], qubits[123], anc[6] )
			yield cirq.TOFFOLI( qubits[17], qubits[116], qubits[124] )
			yield cirq.CNOT( qubits[32], qubits[101] )
			yield cirq.TOFFOLI( qubits[23], qubits[119], qubits[39] )
			yield cirq.TOFFOLI( qubits[18], qubits[72], qubits[49] )
			yield cirq.CNOT( qubits[95], qubits[3] )
			yield cirq.CNOT( qubits[18], qubits[105] )
			yield cirq.CNOT( qubits[77], qubits[43] )
			yield cirq.TOFFOLI( qubits[95], qubits[125], qubits[105] )
			yield cirq.CNOT( qubits[12], qubits[123] )
			yield cirq.TOFFOLI( qubits[55], qubits[102], qubits[32] )
			yield cirq.CNOT( qubits[67], qubits[1] )
			yield cirq.CNOT( qubits[77], qubits[120] )
			yield cirq.TOFFOLI( qubits[79], qubits[26], qubits[21] )
			yield cirq.TOFFOLI( anc[2], qubits[40], qubits[86] )
			yield cirq.CNOT( qubits[96], qubits[102] )
			yield cirq.CNOT( qubits[13], qubits[109] )
			yield cirq.TOFFOLI( qubits[115], qubits[105], qubits[85] )
			yield cirq.TOFFOLI( qubits[20], qubits[71], qubits[73] )
			yield cirq.CNOT( anc[6], anc[1] )
			yield cirq.TOFFOLI( qubits[89], qubits[41], qubits[9] )
			yield cirq.CNOT( qubits[63], qubits[115] )
			yield cirq.CNOT( qubits[106], qubits[22] )
			yield cirq.TOFFOLI( qubits[106], qubits[90], qubits[46] )
			yield cirq.TOFFOLI( qubits[19], qubits[51], qubits[127] )
			yield cirq.CNOT( qubits[112], qubits[113] )
			yield cirq.TOFFOLI( qubits[101], qubits[90], qubits[74] )
			yield cirq.TOFFOLI( qubits[124], qubits[30], qubits[58] )
			yield cirq.TOFFOLI( qubits[65], qubits[118], qubits[57] )
			yield cirq.CNOT( qubits[27], qubits[62] )
			yield cirq.CNOT( qubits[57], qubits[127] )
			yield cirq.CNOT( qubits[45], qubits[96] )
			yield cirq.TOFFOLI( qubits[81], qubits[71], qubits[94] )
			yield cirq.CNOT( qubits[78], qubits[99] )
			yield cirq.TOFFOLI( qubits[104], qubits[111], qubits[119] )
			yield cirq.CNOT( qubits[85], qubits[62] )
			yield cirq.TOFFOLI( qubits[84], qubits[23], qubits[94] )
			yield cirq.CNOT( qubits[72], qubits[60] )
			yield cirq.CNOT( qubits[71], qubits[72] )
			yield cirq.CNOT( qubits[96], qubits[0] )
			yield cirq.CNOT( qubits[24], qubits[54] )
			yield cirq.CNOT( qubits[2], qubits[109] )
			yield cirq.CNOT( qubits[112], qubits[53] )
			yield cirq.TOFFOLI( qubits[64], qubits[86], qubits[120] )
			yield cirq.CNOT( qubits[100], qubits[51] )
			yield cirq.CNOT( qubits[63], qubits[16] )
			yield cirq.TOFFOLI( anc[5], qubits[119], qubits[21] )
			yield cirq.CNOT( qubits[74], qubits[10] )
			yield cirq.CNOT( qubits[97], qubits[99] )
			yield cirq.CNOT( qubits[18], qubits[32] )
			yield cirq.CNOT( qubits[106], qubits[44] )
			yield cirq.TOFFOLI( qubits[22], qubits[121], qubits[2] )
			yield cirq.TOFFOLI( qubits[40], qubits[28], qubits[61] )
			yield cirq.TOFFOLI( qubits[36], qubits[107], anc[2] )
			yield cirq.CNOT( qubits[46], qubits[0] )
			yield cirq.CNOT( qubits[98], qubits[112] )
			yield cirq.TOFFOLI( qubits[33], qubits[70], anc[2] )
			yield cirq.CNOT( qubits[77], qubits[80] )
			yield cirq.TOFFOLI( qubits[24], qubits[127], qubits[62] )
			yield cirq.TOFFOLI( qubits[0], qubits[16], qubits[62] )
			yield cirq.CNOT( qubits[74], qubits[71] )
			yield cirq.TOFFOLI( qubits[16], qubits[65], qubits[118] )
			yield cirq.CNOT( qubits[55], qubits[10] )
			yield cirq.CNOT( qubits[36], qubits[38] )
			yield cirq.CNOT( qubits[57], qubits[63] )
			yield cirq.TOFFOLI( qubits[103], qubits[119], qubits[5] )
			yield cirq.CNOT( qubits[52], qubits[100] )
			yield cirq.TOFFOLI( qubits[23], qubits[64], qubits[93] )
			yield cirq.CNOT( qubits[12], qubits[108] )
			yield cirq.TOFFOLI( qubits[67], qubits[24], qubits[126] )
			yield cirq.TOFFOLI( qubits[22], qubits[115], qubits[28] )
			yield cirq.TOFFOLI( qubits[6], qubits[76], qubits[104] )
			yield cirq.CNOT( qubits[83], qubits[39] )
			yield cirq.TOFFOLI( qubits[57], qubits[39], qubits[112] )
			yield cirq.TOFFOLI( qubits[28], qubits[101], qubits[105] )
			yield cirq.CNOT( anc[7], qubits[18] )
			yield cirq.TOFFOLI( qubits[31], anc[0], qubits[122] )
			yield cirq.CNOT( qubits[127], qubits[8] )
			yield cirq.CNOT( qubits[87], qubits[102] )
			yield cirq.CNOT( qubits[37], qubits[72] )
			yield cirq.TOFFOLI( qubits[48], qubits[13], qubits[9] )
			yield cirq.TOFFOLI( qubits[61], qubits[14], qubits[115] )
			yield cirq.TOFFOLI( qubits[25], qubits[79], qubits[16] )
			yield cirq.TOFFOLI( qubits[32], qubits[63], qubits[74] )
			yield cirq.CNOT( qubits[6], qubits[122] )
			yield cirq.TOFFOLI( anc[2], qubits[74], qubits[107] )
			yield cirq.CNOT( qubits[74], qubits[106] )
			yield cirq.TOFFOLI( anc[7], qubits[104], qubits[94] )
			yield cirq.TOFFOLI( qubits[38], qubits[110], qubits[96] )
			yield cirq.TOFFOLI( qubits[26], qubits[80], qubits[40] )
			yield cirq.CNOT( qubits[93], qubits[23] )
			yield cirq.TOFFOLI( qubits[113], qubits[77], qubits[84] )
			yield cirq.CNOT( qubits[94], qubits[23] )
			yield cirq.CNOT( qubits[0], qubits[16] )
			yield cirq.TOFFOLI( qubits[81], qubits[123], qubits[69] )
			yield cirq.CNOT( qubits[23], qubits[29] )
			yield cirq.TOFFOLI( anc[4], qubits[95], qubits[110] )
			yield cirq.TOFFOLI( qubits[75], qubits[91], qubits[69] )
			yield cirq.CNOT( qubits[7], anc[5] )
			yield cirq.CNOT( qubits[68], qubits[30] )
			yield cirq.CNOT( qubits[73], qubits[69] )
			yield cirq.TOFFOLI( qubits[84], qubits[101], anc[4] )
			yield func3R(*nq1)
			yield cirq.TOFFOLI( anc[7], qubits[31], anc[4] )
			yield cirq.CNOT( qubits[8], qubits[68] )
			yield cirq.CNOT( qubits[87], qubits[116] )
			yield cirq.TOFFOLI( qubits[117], qubits[32], qubits[81] )
			yield cirq.CNOT( qubits[119], qubits[70] )
			yield cirq.CNOT( qubits[127], qubits[38] )
			yield cirq.CNOT( qubits[73], qubits[65] )
			yield cirq.TOFFOLI( qubits[111], qubits[115], qubits[18] )
			yield cirq.TOFFOLI( qubits[58], qubits[35], qubits[43] )
			yield cirq.TOFFOLI( anc[3], qubits[106], qubits[65] )
			yield cirq.CNOT( anc[2], qubits[114] )
			yield cirq.CNOT( qubits[58], qubits[123] )
			yield cirq.TOFFOLI( qubits[89], qubits[5], qubits[110] )
			yield cirq.TOFFOLI( qubits[67], anc[2], qubits[74] )
			yield cirq.CNOT( qubits[92], qubits[18] )
			yield cirq.TOFFOLI( qubits[75], qubits[78], qubits[14] )
			yield cirq.TOFFOLI( qubits[23], qubits[63], qubits[114] )
			yield cirq.CNOT( qubits[119], qubits[82] )
			yield cirq.TOFFOLI( qubits[20], qubits[17], qubits[124] )
			yield cirq.CNOT( qubits[38], qubits[24] )
			yield cirq.CNOT( qubits[64], qubits[50] )
			yield cirq.TOFFOLI( qubits[42], qubits[68], qubits[91] )
			yield cirq.TOFFOLI( qubits[19], qubits[65], qubits[60] )
			yield cirq.CNOT( qubits[6], qubits[122] )
			yield cirq.CNOT( qubits[41], qubits[123] )
			yield cirq.TOFFOLI( qubits[28], qubits[38], qubits[20] )
			yield cirq.CNOT( qubits[117], qubits[39] )
			yield cirq.CNOT( qubits[53], qubits[62] )
			yield cirq.TOFFOLI( qubits[4], qubits[106], qubits[41] )
			yield cirq.TOFFOLI( anc[2], qubits[115], qubits[11] )
			yield cirq.TOFFOLI( qubits[9], qubits[5], qubits[120] )
			yield cirq.TOFFOLI( qubits[73], qubits[109], qubits[54] )
			yield cirq.TOFFOLI( qubits[107], qubits[99], qubits[85] )
			yield cirq.TOFFOLI( qubits[39], qubits[74], qubits[44] )
			yield cirq.CNOT( qubits[25], qubits[49] )
			yield cirq.CNOT( qubits[117], qubits[84] )
			yield cirq.TOFFOLI( qubits[67], qubits[8], qubits[71] )
			yield cirq.TOFFOLI( qubits[53], qubits[8], qubits[60] )
			yield cirq.TOFFOLI( qubits[65], qubits[104], qubits[46] )
			yield cirq.TOFFOLI( qubits[14], qubits[44], qubits[8] )
			yield cirq.CNOT( qubits[2], qubits[104] )
			yield cirq.CNOT( qubits[9], qubits[125] )
			yield cirq.TOFFOLI( qubits[18], qubits[27], qubits[109] )
			yield cirq.TOFFOLI( qubits[109], qubits[43], qubits[73] )
			yield cirq.TOFFOLI( qubits[4], qubits[111], qubits[12] )
			yield cirq.CNOT( qubits[113], qubits[35] )
			yield func2R(*nq0)
			yield cirq.TOFFOLI( qubits[80], qubits[85], qubits[83] )
			yield cirq.CNOT( qubits[7], qubits[67] )
			yield cirq.CNOT( qubits[29], qubits[25] )
			yield cirq.TOFFOLI( qubits[84], qubits[0], qubits[81] )
			yield cirq.TOFFOLI( qubits[68], qubits[95], qubits[112] )
			yield cirq.TOFFOLI( qubits[16], qubits[117], qubits[10] )
			yield cirq.CNOT( qubits[75], qubits[78] )
			yield cirq.CNOT( qubits[7], qubits[78] )
			yield cirq.TOFFOLI( qubits[19], qubits[49], anc[4] )
			yield cirq.TOFFOLI( qubits[61], qubits[36], qubits[124] )
			yield cirq.CNOT( qubits[76], qubits[10] )
			yield cirq.CNOT( qubits[0], qubits[102] )
			yield cirq.CNOT( qubits[50], qubits[14] )
			yield cirq.CNOT( qubits[9], qubits[85] )
			yield cirq.TOFFOLI( qubits[82], qubits[113], qubits[66] )
			yield cirq.TOFFOLI( qubits[10], qubits[13], qubits[27] )
			yield cirq.TOFFOLI( qubits[24], qubits[44], qubits[76] )
			yield cirq.TOFFOLI( qubits[77], qubits[30], qubits[27] )
			yield cirq.CNOT( qubits[121], qubits[39] )
			yield cirq.CNOT( qubits[50], qubits[98] )
			yield cirq.TOFFOLI( qubits[116], qubits[60], qubits[65] )
			yield cirq.TOFFOLI( qubits[43], qubits[70], qubits[65] )
			yield cirq.CNOT( qubits[98], qubits[118] )
			yield cirq.CNOT( qubits[117], qubits[4] )
			yield cirq.CNOT( qubits[57], qubits[26] )
			yield cirq.CNOT( qubits[98], qubits[43] )
			yield cirq.CNOT( qubits[108], qubits[17] )
			yield cirq.CNOT( qubits[68], qubits[28] )
			yield cirq.CNOT( qubits[125], qubits[13] )
			yield cirq.CNOT( qubits[33], qubits[107] )
			yield cirq.TOFFOLI( qubits[83], qubits[123], qubits[59] )
			yield cirq.CNOT( qubits[30], qubits[124] )
			yield cirq.TOFFOLI( qubits[99], qubits[65], qubits[75] )
			yield cirq.TOFFOLI( qubits[2], qubits[18], qubits[42] )
			yield cirq.TOFFOLI( qubits[19], qubits[18], qubits[110] )
			yield cirq.CNOT( qubits[75], qubits[98] )
# main function
def main():
	num_in = 128
	num_anc = 34
	c = cirq.Circuit()
	in_qubits = [cirq.GridQubit(i,0) for i in range(num_in)]
	anc_qubits = [cirq.GridQubit(num_in+i,0) for i in range(num_anc)]
	all_qubits = in_qubits + anc_qubits
	# Intialize random inputs
	c.append([cirq.X(in_qubits[85])])
	c.append([cirq.X(in_qubits[62])])
	c.append([cirq.X(in_qubits[60])])
	c.append([cirq.X(in_qubits[15])])
	c.append([cirq.X(in_qubits[41])])
	c.append([cirq.X(in_qubits[122])])
	c.append([cirq.X(in_qubits[73])])
	c.append([cirq.X(in_qubits[86])])
	c.append([cirq.X(in_qubits[59])])
	c.append([cirq.X(in_qubits[77])])
	c.append([cirq.X(in_qubits[35])])
	c.append([cirq.X(in_qubits[52])])
	c.append([cirq.X(in_qubits[125])])
	c.append([cirq.X(in_qubits[57])])
	c.append([cirq.X(in_qubits[30])])
	c.append([cirq.X(in_qubits[106])])
	c.append([cirq.X(in_qubits[34])])
	# Start computation
	func1 = Func1(162, is_inverse=False)
	circ = func1(*all_qubits)
	func1R = Func1(162, is_inverse=True)
	circR = func1R(*all_qubits)
	c.append([circ])
	c.append([circR])
	c.append([cirq.measure(*in_qubits, key='result')])
	print("Circuit:")
	print(c)
	if num_in + num_anc > 32:
		print("Skipping simulation for circuit size > 32.")
	else:
		simulator = cirq.Simulator()
		result = simulator.run(c, repetitions=1)
		print("Results:")
		print(result)

if __name__ == '__main__':
	main()
